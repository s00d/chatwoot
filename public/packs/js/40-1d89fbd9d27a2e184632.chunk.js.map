{"version":3,"sources":["webpack:///./app/javascript/shared/helpers/markdownIt/link.js","webpack:///./app/javascript/shared/helpers/MessageFormatter.js","webpack:///./app/javascript/shared/mixins/messageFormatterMixin.js","webpack:///./node_modules/@chatwoot/utils/dist/utils.esm.js","webpack:///./app/javascript/shared/components/Button.vue?1617","webpack:///./app/javascript/shared/components/Button.vue?26c2","webpack:///app/javascript/shared/components/Button.vue","webpack:///./app/javascript/shared/components/Button.vue","webpack:///./app/javascript/widget/components/PreChat/Form.vue?bbab","webpack:///./app/javascript/widget/views/PreChatForm.vue?708e","webpack:///app/javascript/widget/components/PreChat/Form.vue","webpack:///./app/javascript/widget/components/PreChat/Form.vue?3f24","webpack:///./app/javascript/widget/components/PreChat/Form.vue","webpack:///./app/javascript/widget/components/PreChat/Form.vue?aa8e","webpack:///./app/javascript/widget/views/PreChatForm.vue?fc86","webpack:///app/javascript/widget/views/PreChatForm.vue","webpack:///./app/javascript/widget/views/PreChatForm.vue"],"names":["USER_MENTIONS_REGEX","processInlineToken","blockToken","children","forEach","inlineToken","type","imgSrc","attrGet","height","URL","searchParams","get","attrSet","setImageHeight","md","require","html","xhtmlOut","breaks","langPrefix","linkify","typographer","quotes","maxNesting","use","renderer","rules","mention","tokens","idx","content","inline","ruler","before","state","silent","label","labelEnd","labelStart","pos","res","token","href","max","posMax","src","charCodeAt","helpers","parseLinkLabel","slice","parseLinkDestination","ok","normalizeLink","str","validateLink","match","RegExp","push","core","after","mila","attrs","class","rel","target","TWITTER_USERNAME_REGEX","TWITTER_HASH_REGEX","MessageFormatter","message","isATweet","isAPrivateNote","this","updatedMessage","replace","render","formatMessage","DOMParser","parseFromString","formattedMessage","body","textContent","methods","getPlainText","plainText","truncateMessage","description","length","highlightContent","searchTerm","highlightClass","plainTextContent","escapedSearchTerm","debounce","func","wait","immediate","timeout","context","args","arguments","later","apply","callNow","clearTimeout","window","setTimeout","getContrastingTextColor","bgColor","color","parseInt","formatTime","timeInSeconds","formattedTime","minutes","Math","floor","seconds","hours","_minutes","days","_hours","trimContent","maxLength","ellipsis","trimmedContent","substring","parseBoolean","candidate","candidateString","String","toLowerCase","Boolean","JSON","parse","error","sortAsc","arr","sort","a","b","_quantileForSorted","sorted","q","min","value","clamped","base","rest","undefined","getQuantileIntervals","data","intervals","map","interval","MESSAGE_VARIABLES_REGEX","capitalizeName","name","s","toUpperCase","getFirstName","_ref","user","firstName","split","shift","getLastName","_ref2","lastName","pop","getMessageVariables","_ref3","_assignee$email","conversation","_conversation$meta","meta","assignee","sender","id","email","phone_number","replaceVariablesInMessage","_ref4","variables","_","trim","getUndefinedVariablesInMessage","_ref5","matches","filter","variable","component","_vm","_c","_self","buttonClassName","style","disabled","on","onClick","_t","staticClass","onSubmit","model","callback","$$v","formValues","expression","directives","rawName","headerMessage","$dm","_e","_v","_l","item","key","getLabel","getPlaceHolder","getValidation","getOptions","labelClass","inputClass","startsWithPlus","$t","isValidPhoneNumber","required","hasErrorInPhoneInput","hasActiveCampaign","widgetColor","textColor","isCreating","_s","preChatFormOptions"],"mappings":"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","file":"js/40-1d89fbd9d27a2e184632.chunk.js","sourcesContent":["// Process [@mention](mention://user/1/Pranav)\nconst USER_MENTIONS_REGEX = /mention:\\/\\/(user|team)\\/(\\d+)\\/(.+)/gm;\n\nconst buildMentionTokens = () => (state, silent) => {\n  var label;\n  var labelEnd;\n  var labelStart;\n  var pos;\n  var res;\n  var token;\n  var href = '';\n  var max = state.posMax;\n\n  if (state.src.charCodeAt(state.pos) !== 0x5b /* [ */) {\n    return false;\n  }\n\n  labelStart = state.pos + 1;\n  labelEnd = state.md.helpers.parseLinkLabel(state, state.pos, true);\n\n  // parser failed to find ']', so it's not a valid link\n  if (labelEnd < 0) {\n    return false;\n  }\n\n  label = state.src.slice(labelStart, labelEnd);\n  pos = labelEnd + 1;\n\n  if (pos < max && state.src.charCodeAt(pos) === 0x28 /* ( */) {\n    pos += 1;\n    res = state.md.helpers.parseLinkDestination(state.src, pos, state.posMax);\n    if (res.ok) {\n      href = state.md.normalizeLink(res.str);\n      if (state.md.validateLink(href)) {\n        pos = res.pos;\n      } else {\n        href = '';\n      }\n    }\n    pos += 1;\n  }\n\n  if (!href.match(new RegExp(USER_MENTIONS_REGEX))) {\n    return false;\n  }\n\n  if (!silent) {\n    state.pos = labelStart;\n    state.posMax = labelEnd;\n\n    token = state.push('mention', '');\n    token.href = href;\n    token.content = label;\n  }\n\n  state.pos = pos;\n  state.posMax = max;\n\n  return true;\n};\n\nconst renderMentions = () => (tokens, idx) => {\n  return `<span class=\"prosemirror-mention-node\">${tokens[idx].content}</span>`;\n};\n\nexport default function mentionPlugin(md) {\n  md.renderer.rules.mention = renderMentions(md);\n  md.inline.ruler.before('link', 'mention', buildMentionTokens(md));\n}\n","import mila from 'markdown-it-link-attributes';\nimport mentionPlugin from './markdownIt/link';\n\nconst setImageHeight = inlineToken => {\n  const imgSrc = inlineToken.attrGet('src');\n  if (!imgSrc) return;\n  const url = new URL(imgSrc);\n  const height = url.searchParams.get('cw_image_height');\n  if (!height) return;\n  inlineToken.attrSet('style', `height: ${height};`);\n};\n\nconst processInlineToken = blockToken => {\n  blockToken.children.forEach(inlineToken => {\n    if (inlineToken.type === 'image') {\n      setImageHeight(inlineToken);\n    }\n  });\n};\n\nconst imgResizeManager = md => {\n  // Custom rule for image resize in markdown\n  // If the image url has a query param cw_image_height, then add a style attribute to the image\n  md.core.ruler.after('inline', 'add-image-height', state => {\n    state.tokens.forEach(blockToken => {\n      if (blockToken.type === 'inline') {\n        processInlineToken(blockToken);\n      }\n    });\n  });\n};\n\nconst md = require('markdown-it')({\n  html: false,\n  xhtmlOut: true,\n  breaks: true,\n  langPrefix: 'language-',\n  linkify: true,\n  typographer: true,\n  quotes: '\\u201c\\u201d\\u2018\\u2019',\n  maxNesting: 20,\n})\n  .use(mentionPlugin)\n  .use(imgResizeManager)\n  .use(mila, {\n    attrs: {\n      class: 'link',\n      rel: 'noreferrer noopener nofollow',\n      target: '_blank',\n    },\n  });\n\nconst TWITTER_USERNAME_REGEX = /(^|[^@\\w])@(\\w{1,15})\\b/g;\nconst TWITTER_USERNAME_REPLACEMENT = '$1[@$2](http://twitter.com/$2)';\nconst TWITTER_HASH_REGEX = /(^|\\s)#(\\w+)/g;\nconst TWITTER_HASH_REPLACEMENT = '$1[#$2](https://twitter.com/hashtag/$2)';\n\nclass MessageFormatter {\n  constructor(message, isATweet = false, isAPrivateNote = false) {\n    this.message = message || '';\n    this.isAPrivateNote = isAPrivateNote;\n    this.isATweet = isATweet;\n  }\n\n  formatMessage() {\n    let updatedMessage = this.message;\n    if (this.isATweet && !this.isAPrivateNote) {\n      updatedMessage = updatedMessage.replace(\n        TWITTER_USERNAME_REGEX,\n        TWITTER_USERNAME_REPLACEMENT\n      );\n      updatedMessage = updatedMessage.replace(\n        TWITTER_HASH_REGEX,\n        TWITTER_HASH_REPLACEMENT\n      );\n    }\n    return md.render(updatedMessage);\n  }\n\n  get formattedMessage() {\n    return this.formatMessage();\n  }\n\n  get plainText() {\n    const strippedOutHtml = new DOMParser().parseFromString(\n      this.formattedMessage,\n      'text/html'\n    );\n    return strippedOutHtml.body.textContent || '';\n  }\n}\n\nexport default MessageFormatter;\n","import MessageFormatter from '../helpers/MessageFormatter';\n\nexport default {\n  methods: {\n    formatMessage(message, isATweet, isAPrivateNote) {\n      const messageFormatter = new MessageFormatter(\n        message,\n        isATweet,\n        isAPrivateNote\n      );\n      return messageFormatter.formattedMessage;\n    },\n    getPlainText(message, isATweet) {\n      const messageFormatter = new MessageFormatter(message, isATweet);\n      return messageFormatter.plainText;\n    },\n    truncateMessage(description = '') {\n      if (description.length < 100) {\n        return description;\n      }\n\n      return `${description.slice(0, 97)}...`;\n    },\n\n    highlightContent(content = '', searchTerm = '', highlightClass = '') {\n      const plainTextContent = this.getPlainText(content);\n\n      // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions#escaping\n      const escapedSearchTerm = searchTerm.replace(\n        /[.*+?^${}()|[\\]\\\\]/g,\n        '\\\\$&'\n      );\n\n      return plainTextContent.replace(\n        new RegExp(`(${escapedSearchTerm})`, 'ig'),\n        `<span class=\"${highlightClass}\">$1</span>`\n      );\n    },\n  },\n};\n","import isToday from 'date-fns/isToday';\nimport isYesterday from 'date-fns/isYesterday'; // Returns a function, that, as long as it continues to be invoked, will not\n// be triggered. The function will be called after it stops being called for\n// N milliseconds. If `immediate` is passed, trigger the function on the\n// leading edge, instead of the trailing.\n\n/**\r\n * @func Callback function to be called after delay\r\n * @delay Delay for debounce in ms\r\n * @immediate should execute immediately\r\n * @returns debounced callback function\r\n */\n\nvar debounce = function debounce(func, wait, immediate) {\n  var timeout;\n  return function () {\n    var context = null;\n    var args = arguments;\n\n    var later = function later() {\n      timeout = null;\n      if (!immediate) func.apply(context, args);\n    };\n\n    var callNow = immediate && !timeout;\n    clearTimeout(timeout);\n    timeout = window.setTimeout(later, wait);\n    if (callNow) func.apply(context, args);\n  };\n};\n/**\r\n * @name Get contrasting text color\r\n * @description Get contrasting text color from a text color\r\n * @param bgColor  Background color of text.\r\n * @returns contrasting text color\r\n */\n\n\nvar getContrastingTextColor = function getContrastingTextColor(bgColor) {\n  var color = bgColor.replace('#', '');\n  var r = parseInt(color.slice(0, 2), 16);\n  var g = parseInt(color.slice(2, 4), 16);\n  var b = parseInt(color.slice(4, 6), 16); // http://stackoverflow.com/a/3943023/112731\n\n  return r * 0.299 + g * 0.587 + b * 0.114 > 186 ? '#000000' : '#FFFFFF';\n};\n/**\r\n * @name Get formatted date\r\n * @description Get date in today, yesterday or any other date format\r\n * @param date  date\r\n * @param todayText  Today text\r\n * @param yesterdayText  Yesterday text\r\n * @returns formatted date\r\n */\n\n\nvar formatDate = function formatDate(_ref) {\n  var date = _ref.date,\n      todayText = _ref.todayText,\n      yesterdayText = _ref.yesterdayText;\n  var dateValue = new Date(date);\n  if (isToday(dateValue)) return todayText;\n  if (isYesterday(dateValue)) return yesterdayText;\n  return date;\n};\n/**\r\n * @name formatTime\r\n * @description Format time to Hour, Minute and Second\r\n * @param timeInSeconds  number\r\n * @returns formatted time\r\n */\n\n\nvar formatTime = function formatTime(timeInSeconds) {\n  var formattedTime = '';\n\n  if (timeInSeconds >= 60 && timeInSeconds < 3600) {\n    var minutes = Math.floor(timeInSeconds / 60);\n    formattedTime = minutes + \" Min\";\n    var seconds = minutes === 60 ? 0 : Math.floor(timeInSeconds % 60);\n    return formattedTime + (\"\" + (seconds > 0 ? ' ' + seconds + ' Sec' : ''));\n  }\n\n  if (timeInSeconds >= 3600 && timeInSeconds < 86400) {\n    var hours = Math.floor(timeInSeconds / 3600);\n    formattedTime = hours + \" Hr\";\n\n    var _minutes = timeInSeconds % 3600 < 60 || hours === 24 ? 0 : Math.floor(timeInSeconds % 3600 / 60);\n\n    return formattedTime + (\"\" + (_minutes > 0 ? ' ' + _minutes + ' Min' : ''));\n  }\n\n  if (timeInSeconds >= 86400) {\n    var days = Math.floor(timeInSeconds / 86400);\n    formattedTime = days + \" Day\";\n\n    var _hours = timeInSeconds % 86400 < 3600 || days >= 364 ? 0 : Math.floor(timeInSeconds % 86400 / 3600);\n\n    return formattedTime + (\"\" + (_hours > 0 ? ' ' + _hours + ' Hr' : ''));\n  }\n\n  return Math.floor(timeInSeconds) + \" Sec\";\n};\n/**\r\n * @name trimContent\r\n * @description Trim a string to max length\r\n * @param content String to trim\r\n * @param maxLength Length of the string to trim, default 1024\r\n * @param ellipsis Boolean to add dots at the end of the string, default false\r\n * @returns trimmed string\r\n */\n\n\nvar trimContent = function trimContent(content, maxLength, ellipsis) {\n  if (content === void 0) {\n    content = '';\n  }\n\n  if (maxLength === void 0) {\n    maxLength = 1024;\n  }\n\n  if (ellipsis === void 0) {\n    ellipsis = false;\n  }\n\n  var trimmedContent = content;\n\n  if (content.length > maxLength) {\n    trimmedContent = content.substring(0, maxLength);\n  }\n\n  if (ellipsis) {\n    trimmedContent = trimmedContent + '...';\n  }\n\n  return trimmedContent;\n};\n/**\r\n * Function that parses a string boolean value and returns the corresponding boolean value\r\n * @param {string | number} candidate - The string boolean value to be parsed\r\n * @return {boolean} - The parsed boolean value\r\n */\n\n\nfunction parseBoolean(candidate) {\n  try {\n    // lowercase the string, so TRUE becomes true\n    var candidateString = String(candidate).toLowerCase(); // wrap in boolean to ensure that the return value\n    // is a boolean even if values like 0 or 1 are passed\n\n    return Boolean(JSON.parse(candidateString));\n  } catch (error) {\n    return false;\n  }\n}\n/**\r\n * Sorts an array of numbers in ascending order.\r\n * @param {number[]} arr - The array of numbers to be sorted.\r\n * @returns {number[]} - The sorted array.\r\n */\n\n\nfunction sortAsc(arr) {\n  // .slice() is used to create a copy of the array so that the original array is not mutated\n  return arr.slice().sort(function (a, b) {\n    return a - b;\n  });\n}\n/**\r\n * Calculates the quantile value of an array at a specified percentile.\r\n * @param {number[]} arr - The array of numbers to calculate the quantile value from.\r\n * @param {number} q - The percentile to calculate the quantile value for.\r\n * @returns {number} - The quantile value.\r\n */\n\n\nfunction quantile(arr, q) {\n  var sorted = sortAsc(arr); // Sort the array in ascending order\n\n  return _quantileForSorted(sorted, q); // Calculate the quantile value\n}\n/**\r\n * Clamps a value between a minimum and maximum range.\r\n * @param {number} min - The minimum range.\r\n * @param {number} max - The maximum range.\r\n * @param {number} value - The value to be clamped.\r\n * @returns {number} - The clamped value.\r\n */\n\n\nfunction clamp(min, max, value) {\n  if (value < min) {\n    return min;\n  }\n\n  if (value > max) {\n    return max;\n  }\n\n  return value;\n}\n/**\r\n * This method assumes the the array provided is already sorted in ascending order.\r\n * It's a helper method for the quantile method and should not be exported as is.\r\n *\r\n * @param {number[]} arr - The array of numbers to calculate the quantile value from.\r\n * @param {number} q - The percentile to calculate the quantile value for.\r\n * @returns {number} - The quantile value.\r\n */\n\n\nfunction _quantileForSorted(sorted, q) {\n  var clamped = clamp(0, 1, q); // Clamp the percentile between 0 and 1\n\n  var pos = (sorted.length - 1) * clamped; // Calculate the index of the element at the specified percentile\n\n  var base = Math.floor(pos); // Find the index of the closest element to the specified percentile\n\n  var rest = pos - base; // Calculate the decimal value between the closest elements\n  // Interpolate the quantile value between the closest elements\n  // Most libraries don't to the interpolation, but I'm just having fun here\n  // also see https://en.wikipedia.org/wiki/Quantile#Estimating_quantiles_from_a_sample\n\n  if (sorted[base + 1] !== undefined) {\n    // in case the position was a integer, the rest will be 0 and the interpolation will be skipped\n    return sorted[base] + rest * (sorted[base + 1] - sorted[base]);\n  } // Return the closest element if there is no interpolation possible\n\n\n  return sorted[base];\n}\n/**\r\n * Calculates the quantile values for an array of intervals.\r\n * @param {number[]} data - The array of numbers to calculate the quantile values from.\r\n * @param {number[]} intervals - The array of intervals to calculate the quantile values for.\r\n * @returns {number[]} - The array of quantile values for the intervals.\r\n */\n\n\nvar getQuantileIntervals = function getQuantileIntervals(data, intervals) {\n  // Sort the array in ascending order before looping through the intervals.\n  // depending on the size of the array and the number of intervals, this can speed up the process by at least twice\n  // for a random array of 100 numbers and 5 intervals, the speedup is 3x\n  var sorted = sortAsc(data);\n  return intervals.map(function (interval) {\n    return _quantileForSorted(sorted, interval);\n  });\n};\n\nvar MESSAGE_VARIABLES_REGEX = /{{(.*?)}}/g;\n\nvar skipCodeBlocks = function skipCodeBlocks(str) {\n  return str.replace(/```(?:.|\\n)+?```/g, '');\n};\n\nvar capitalizeName = function capitalizeName(name) {\n  return (name || '').replace(/\\b(\\w)/g, function (s) {\n    return s.toUpperCase();\n  });\n};\n\nvar getFirstName = function getFirstName(_ref) {\n  var user = _ref.user;\n  var firstName = user != null && user.name ? user.name.split(' ').shift() : '';\n  return capitalizeName(firstName);\n};\n\nvar getLastName = function getLastName(_ref2) {\n  var user = _ref2.user;\n\n  if (user && user.name) {\n    var lastName = user.name.split(' ').length > 1 ? user.name.split(' ').pop() : '';\n    return capitalizeName(lastName);\n  }\n\n  return '';\n};\n\nvar getMessageVariables = function getMessageVariables(_ref3) {\n  var _assignee$email;\n\n  var conversation = _ref3.conversation;\n  var _conversation$meta = conversation.meta,\n      assignee = _conversation$meta.assignee,\n      sender = _conversation$meta.sender,\n      id = conversation.id;\n  return {\n    'contact.name': capitalizeName((sender == null ? void 0 : sender.name) || ''),\n    'contact.first_name': getFirstName({\n      user: sender\n    }),\n    'contact.last_name': getLastName({\n      user: sender\n    }),\n    'contact.email': sender == null ? void 0 : sender.email,\n    'contact.phone': sender == null ? void 0 : sender.phone_number,\n    'contact.id': sender == null ? void 0 : sender.id,\n    'conversation.id': id,\n    'agent.name': capitalizeName((assignee == null ? void 0 : assignee.name) || ''),\n    'agent.first_name': getFirstName({\n      user: assignee\n    }),\n    'agent.last_name': getLastName({\n      user: assignee\n    }),\n    'agent.email': (_assignee$email = assignee == null ? void 0 : assignee.email) != null ? _assignee$email : ''\n  };\n};\n\nvar replaceVariablesInMessage = function replaceVariablesInMessage(_ref4) {\n  var message = _ref4.message,\n      variables = _ref4.variables; // @ts-ignore\n\n  return message.replace(MESSAGE_VARIABLES_REGEX, function (_, replace) {\n    return variables[replace.trim()] ? variables[replace.trim().toLowerCase()] : '';\n  });\n};\n\nvar getUndefinedVariablesInMessage = function getUndefinedVariablesInMessage(_ref5) {\n  var message = _ref5.message,\n      variables = _ref5.variables;\n  var messageWithOutCodeBlocks = skipCodeBlocks(message);\n  var matches = messageWithOutCodeBlocks.match(MESSAGE_VARIABLES_REGEX);\n  if (!matches) return [];\n  return matches.map(function (match) {\n    return match.replace('{{', '').replace('}}', '').trim();\n  }).filter(function (variable) {\n    return !variables[variable];\n  });\n};\n\nexport { clamp, debounce, formatDate, formatTime, getContrastingTextColor, getMessageVariables, getQuantileIntervals, getUndefinedVariablesInMessage, parseBoolean, quantile, replaceVariablesInMessage, sortAsc, trimContent };","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('button',{class:_vm.buttonClassName,style:(_vm.buttonStyles),attrs:{\"disabled\":_vm.disabled},on:{\"click\":_vm.onClick}},[_vm._t(\"default\")],2)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import mod from \"-!../../../../node_modules/babel-loader/lib/index.js??ref--7-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Button.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/babel-loader/lib/index.js??ref--7-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Button.vue?vue&type=script&lang=js&\"","<template>\n  <button\n    :class=\"buttonClassName\"\n    :style=\"buttonStyles\"\n    :disabled=\"disabled\"\n    @click=\"onClick\"\n  >\n    <slot />\n  </button>\n</template>\n<script>\nexport default {\n  props: {\n    block: {\n      type: Boolean,\n      default: false,\n    },\n    type: {\n      type: String,\n      default: 'blue',\n    },\n    bgColor: {\n      type: String,\n      default: '',\n    },\n    textColor: {\n      type: String,\n      default: '',\n    },\n    disabled: {\n      type: Boolean,\n      default: false,\n    },\n  },\n  computed: {\n    buttonClassName() {\n      let className = 'text-white py-3 px-4 rounded shadow-sm leading-4';\n      if (this.type === 'clear') {\n        className = 'flex mx-auto mt-4 text-xs leading-3 w-auto text-black-600';\n      }\n\n      if (this.type === 'blue' && !Object.keys(this.buttonStyles).length) {\n        className = `${className} bg-woot-500 hover:bg-woot-700`;\n      }\n      if (this.block) {\n        className = `${className} w-full`;\n      }\n      return className;\n    },\n    buttonStyles() {\n      const styles = {};\n      if (this.bgColor) {\n        styles.backgroundColor = this.bgColor;\n      }\n      if (this.textColor) {\n        styles.color = this.textColor;\n      }\n      return styles;\n    },\n  },\n  methods: {\n    onClick(e) {\n      this.$emit('click', e);\n    },\n  },\n};\n</script>\n","import { render, staticRenderFns } from \"./Button.vue?vue&type=template&id=05075a0e&\"\nimport script from \"./Button.vue?vue&type=script&lang=js&\"\nexport * from \"./Button.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js!../../../../../node_modules/css-loader/dist/cjs.js??ref--3-1!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/postcss-loader/dist/cjs.js??ref--3-2!../../../../../node_modules/sass-loader/dist/cjs.js??ref--3-3!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Form.vue?vue&type=style&index=0&id=618e6854&prod&lang=scss&scoped=true&\"","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"flex flex-1 overflow-auto\"},[_c('pre-chat-form',{attrs:{\"options\":_vm.preChatFormOptions},on:{\"submit\":_vm.onSubmit}})],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <FormulateForm\n    v-model=\"formValues\"\n    class=\"flex flex-1 flex-col p-6 overflow-y-auto\"\n    @submit=\"onSubmit\"\n  >\n    <div\n      v-if=\"shouldShowHeaderMessage\"\n      v-dompurify-html=\"formatMessage(headerMessage, false)\"\n      class=\"mb-4 text-sm leading-5 pre-chat-header-message\"\n      :class=\"$dm('text-black-800', 'dark:text-slate-50')\"\n    />\n    <FormulateInput\n      v-for=\"item in enabledPreChatFields\"\n      :key=\"item.name\"\n      :name=\"item.name\"\n      :type=\"item.type\"\n      :label=\"getLabel(item)\"\n      :placeholder=\"getPlaceHolder(item)\"\n      :validation=\"getValidation(item)\"\n      :options=\"getOptions(item)\"\n      :label-class=\"context => labelClass(context)\"\n      :input-class=\"context => inputClass(context)\"\n      :validation-messages=\"{\n        startsWithPlus: $t(\n          'PRE_CHAT_FORM.FIELDS.PHONE_NUMBER.DIAL_CODE_VALID_ERROR'\n        ),\n        isValidPhoneNumber: $t('PRE_CHAT_FORM.FIELDS.PHONE_NUMBER.VALID_ERROR'),\n        email: $t('PRE_CHAT_FORM.FIELDS.EMAIL_ADDRESS.VALID_ERROR'),\n        required: $t('PRE_CHAT_FORM.REQUIRED'),\n      }\"\n      :has-error-in-phone-input=\"hasErrorInPhoneInput\"\n    />\n    <FormulateInput\n      v-if=\"!hasActiveCampaign\"\n      name=\"message\"\n      type=\"textarea\"\n      :label-class=\"context => labelClass(context)\"\n      :input-class=\"context => inputClass(context)\"\n      :label=\"$t('PRE_CHAT_FORM.FIELDS.MESSAGE.LABEL')\"\n      :placeholder=\"$t('PRE_CHAT_FORM.FIELDS.MESSAGE.PLACEHOLDER')\"\n      validation=\"required\"\n      :validation-messages=\"{\n        required: $t('PRE_CHAT_FORM.FIELDS.MESSAGE.ERROR'),\n      }\"\n    />\n\n    <custom-button\n      class=\"font-medium mt-2 mb-5\"\n      block\n      :bg-color=\"widgetColor\"\n      :text-color=\"textColor\"\n      :disabled=\"isCreating\"\n    >\n      <spinner v-if=\"isCreating\" class=\"p-0\" />\n      {{ $t('START_CONVERSATION') }}\n    </custom-button>\n  </FormulateForm>\n</template>\n\n<script>\nimport CustomButton from 'shared/components/Button.vue';\nimport Spinner from 'shared/components/Spinner.vue';\nimport { mapGetters } from 'vuex';\nimport { getContrastingTextColor } from '@chatwoot/utils';\nimport messageFormatterMixin from 'shared/mixins/messageFormatterMixin';\nimport { isEmptyObject } from 'widget/helpers/utils';\nimport routerMixin from 'widget/mixins/routerMixin';\nimport darkModeMixin from 'widget/mixins/darkModeMixin';\nimport configMixin from 'widget/mixins/configMixin';\n\nexport default {\n  components: {\n    CustomButton,\n    Spinner,\n  },\n  mixins: [routerMixin, darkModeMixin, messageFormatterMixin, configMixin],\n  props: {\n    options: {\n      type: Object,\n      default: () => {},\n    },\n  },\n  data() {\n    return {\n      locale: this.$root.$i18n.locale,\n      hasErrorInPhoneInput: false,\n      message: '',\n      formValues: {},\n      labels: {\n        emailAddress: 'EMAIL_ADDRESS',\n        fullName: 'FULL_NAME',\n        phoneNumber: 'PHONE_NUMBER',\n      },\n    };\n  },\n  computed: {\n    ...mapGetters({\n      widgetColor: 'appConfig/getWidgetColor',\n      isCreating: 'conversation/getIsCreating',\n      activeCampaign: 'campaign/getActiveCampaign',\n      currentUser: 'contacts/getCurrentUser',\n    }),\n    textColor() {\n      return getContrastingTextColor(this.widgetColor);\n    },\n    hasActiveCampaign() {\n      return !isEmptyObject(this.activeCampaign);\n    },\n    shouldShowHeaderMessage() {\n      return this.hasActiveCampaign || this.preChatFormEnabled;\n    },\n    headerMessage() {\n      if (this.preChatFormEnabled) {\n        return this.options.preChatMessage;\n      }\n      if (this.hasActiveCampaign) {\n        return this.$t('PRE_CHAT_FORM.CAMPAIGN_HEADER');\n      }\n      return '';\n    },\n    preChatFields() {\n      return this.preChatFormEnabled ? this.options.preChatFields : [];\n    },\n    filteredPreChatFields() {\n      const isUserEmailAvailable = !!this.currentUser.email;\n      const isUserPhoneNumberAvailable = !!this.currentUser.phone_number;\n      const isUserIdentifierAvailable = !!this.currentUser.identifier;\n      const isUserNameAvailable = !!(\n        isUserIdentifierAvailable ||\n        isUserEmailAvailable ||\n        isUserPhoneNumberAvailable\n      );\n      return this.preChatFields.filter(field => {\n        if (isUserEmailAvailable && field.name === 'emailAddress') {\n          return false;\n        }\n        if (isUserPhoneNumberAvailable && field.name === 'phoneNumber') {\n          return false;\n        }\n        if (isUserNameAvailable && field.name === 'fullName') {\n          return false;\n        }\n        return true;\n      });\n    },\n    enabledPreChatFields() {\n      return this.filteredPreChatFields\n        .filter(field => field.enabled)\n        .map(field => ({\n          ...field,\n          type:\n            field.name === 'phoneNumber'\n              ? 'phoneInput'\n              : this.findFieldType(field.type),\n        }));\n    },\n    conversationCustomAttributes() {\n      let conversationAttributes = {};\n      this.enabledPreChatFields.forEach(field => {\n        if (field.field_type === 'conversation_attribute') {\n          conversationAttributes = {\n            ...conversationAttributes,\n            [field.name]: this.getValue(field),\n          };\n        }\n      });\n      return conversationAttributes;\n    },\n    contactCustomAttributes() {\n      let contactAttributes = {};\n      this.enabledPreChatFields.forEach(field => {\n        if (field.field_type === 'contact_attribute') {\n          contactAttributes = {\n            ...contactAttributes,\n            [field.name]: this.getValue(field),\n          };\n        }\n      });\n      return contactAttributes;\n    },\n    inputStyles() {\n      return `mt-1 border rounded w-full py-2 px-3 text-slate-700 outline-none`;\n    },\n    isInputDarkOrLightMode() {\n      return `${this.$dm('bg-white', 'dark:bg-slate-600')} ${this.$dm(\n        'text-slate-700',\n        'dark:text-slate-50'\n      )}`;\n    },\n    inputBorderColor() {\n      return `${this.$dm('border-black-200', 'dark:border-black-500')}`;\n    },\n  },\n  methods: {\n    labelClass(context) {\n      const { hasErrors } = context;\n      if (!hasErrors) {\n        return `text-xs font-medium ${this.$dm(\n          'text-black-800',\n          'dark:text-slate-50'\n        )}`;\n      }\n      return `text-xs font-medium ${this.$dm(\n        'text-red-400',\n        'dark:text-red-400'\n      )}`;\n    },\n    inputClass(context) {\n      const { hasErrors, classification, type } = context;\n      if (classification === 'box' && type === 'checkbox') {\n        return '';\n      }\n      if (type === 'phoneInput') {\n        this.hasErrorInPhoneInput = hasErrors;\n      }\n      if (!hasErrors) {\n        return `${this.inputStyles} hover:border-black-300 focus:border-black-300 ${this.isInputDarkOrLightMode} ${this.inputBorderColor}`;\n      }\n      return `${this.inputStyles} border-red-200 hover:border-red-300 focus:border-red-300 ${this.isInputDarkOrLightMode}`;\n    },\n    isContactFieldRequired(field) {\n      return this.preChatFields.find(option => option.name === field).required;\n    },\n    getLabel({ label }) {\n      return label;\n    },\n    getPlaceHolder({ placeholder }) {\n      return placeholder;\n    },\n    getValue({ name, type }) {\n      if (type === 'select') {\n        return this.enabledPreChatFields.find(option => option.name === name)\n          .values[this.formValues[name]];\n      }\n      return this.formValues[name] || null;\n    },\n    getValidation({ type, name }) {\n      const validations = {\n        emailAddress: 'email',\n        phoneNumber: 'startsWithPlus|isValidPhoneNumber',\n        url: 'url',\n        date: 'date',\n        text: null,\n        select: null,\n        number: null,\n        checkbox: false,\n      };\n      const validationKeys = Object.keys(validations);\n      const isRequired = this.isContactFieldRequired(name);\n      const validation = isRequired ? 'bail|required' : 'bail|optional';\n\n      if (validationKeys.includes(name) || validationKeys.includes(type)) {\n        const validationType = validations[type] || validations[name];\n        const validationString = validationType\n          ? `${validation}|${validationType}`\n          : validation;\n        return validationString;\n      }\n\n      return '';\n    },\n    findFieldType(type) {\n      if (type === 'link') {\n        return 'url';\n      }\n      if (type === 'list') {\n        return 'select';\n      }\n\n      return type;\n    },\n    getOptions(item) {\n      if (item.type === 'select') {\n        let values = {};\n        item.values.forEach((value, index) => {\n          values = {\n            ...values,\n            [index]: value,\n          };\n        });\n        return values;\n      }\n      return null;\n    },\n    onSubmit() {\n      const { emailAddress, fullName, phoneNumber, message } = this.formValues;\n      const { email } = this.currentUser;\n      this.$emit('submit', {\n        fullName,\n        phoneNumber,\n        emailAddress: emailAddress || email,\n        message,\n        activeCampaignId: this.activeCampaign.id,\n        conversationCustomAttributes: this.conversationCustomAttributes,\n        contactCustomAttributes: this.contactCustomAttributes,\n      });\n    },\n  },\n};\n</script>\n<style lang=\"scss\" scoped>\n@import '~widget/assets/scss/variables.scss';\n::v-deep {\n  .wrapper[data-type='checkbox'] {\n    .formulate-input-wrapper {\n      display: flex;\n      align-items: center;\n      line-height: $space-normal;\n\n      label {\n        margin-left: 0.2rem;\n      }\n    }\n  }\n  @media (prefers-color-scheme: dark) {\n    .wrapper {\n      .formulate-input-element--date,\n      .formulate-input-element--checkbox {\n        input {\n          color-scheme: dark;\n        }\n      }\n    }\n  }\n  .wrapper[data-type='textarea'] {\n    .formulate-input-element--textarea {\n      textarea {\n        min-height: 8rem;\n      }\n    }\n  }\n  .pre-chat-header-message {\n    .link {\n      color: $color-woot;\n      text-decoration: underline;\n    }\n  }\n}\n</style>\n","import mod from \"-!../../../../../node_modules/babel-loader/lib/index.js??ref--7-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Form.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../node_modules/babel-loader/lib/index.js??ref--7-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Form.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Form.vue?vue&type=template&id=618e6854&scoped=true&\"\nimport script from \"./Form.vue?vue&type=script&lang=js&\"\nexport * from \"./Form.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Form.vue?vue&type=style&index=0&id=618e6854&prod&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"618e6854\",\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('FormulateForm',{staticClass:\"flex flex-1 flex-col p-6 overflow-y-auto\",on:{\"submit\":_vm.onSubmit},model:{value:(_vm.formValues),callback:function ($$v) {_vm.formValues=$$v},expression:\"formValues\"}},[(_vm.shouldShowHeaderMessage)?_c('div',{directives:[{name:\"dompurify-html\",rawName:\"v-dompurify-html\",value:(_vm.formatMessage(_vm.headerMessage, false)),expression:\"formatMessage(headerMessage, false)\"}],staticClass:\"mb-4 text-sm leading-5 pre-chat-header-message\",class:_vm.$dm('text-black-800', 'dark:text-slate-50')}):_vm._e(),_vm._v(\" \"),_vm._l((_vm.enabledPreChatFields),function(item){return _c('FormulateInput',{key:item.name,attrs:{\"name\":item.name,\"type\":item.type,\"label\":_vm.getLabel(item),\"placeholder\":_vm.getPlaceHolder(item),\"validation\":_vm.getValidation(item),\"options\":_vm.getOptions(item),\"label-class\":context => _vm.labelClass(context),\"input-class\":context => _vm.inputClass(context),\"validation-messages\":{\n      startsWithPlus: _vm.$t(\n        'PRE_CHAT_FORM.FIELDS.PHONE_NUMBER.DIAL_CODE_VALID_ERROR'\n      ),\n      isValidPhoneNumber: _vm.$t('PRE_CHAT_FORM.FIELDS.PHONE_NUMBER.VALID_ERROR'),\n      email: _vm.$t('PRE_CHAT_FORM.FIELDS.EMAIL_ADDRESS.VALID_ERROR'),\n      required: _vm.$t('PRE_CHAT_FORM.REQUIRED'),\n    },\"has-error-in-phone-input\":_vm.hasErrorInPhoneInput}})}),_vm._v(\" \"),(!_vm.hasActiveCampaign)?_c('FormulateInput',{attrs:{\"name\":\"message\",\"type\":\"textarea\",\"label-class\":context => _vm.labelClass(context),\"input-class\":context => _vm.inputClass(context),\"label\":_vm.$t('PRE_CHAT_FORM.FIELDS.MESSAGE.LABEL'),\"placeholder\":_vm.$t('PRE_CHAT_FORM.FIELDS.MESSAGE.PLACEHOLDER'),\"validation\":\"required\",\"validation-messages\":{\n      required: _vm.$t('PRE_CHAT_FORM.FIELDS.MESSAGE.ERROR'),\n    }}}):_vm._e(),_vm._v(\" \"),_c('custom-button',{staticClass:\"font-medium mt-2 mb-5\",attrs:{\"block\":\"\",\"bg-color\":_vm.widgetColor,\"text-color\":_vm.textColor,\"disabled\":_vm.isCreating}},[(_vm.isCreating)?_c('spinner',{staticClass:\"p-0\"}):_vm._e(),_vm._v(\"\\n    \"+_vm._s(_vm.$t('START_CONVERSATION'))+\"\\n  \")],1)],2)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import mod from \"-!../../../../node_modules/babel-loader/lib/index.js??ref--7-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PreChatForm.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/babel-loader/lib/index.js??ref--7-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PreChatForm.vue?vue&type=script&lang=js&\"","<template>\n  <div class=\"flex flex-1 overflow-auto\">\n    <pre-chat-form :options=\"preChatFormOptions\" @submit=\"onSubmit\" />\n  </div>\n</template>\n<script>\nimport PreChatForm from '../components/PreChat/Form.vue';\nimport configMixin from '../mixins/configMixin';\nimport routerMixin from '../mixins/routerMixin';\nimport { isEmptyObject } from 'widget/helpers/utils';\nimport { ON_CONVERSATION_CREATED } from '../constants/widgetBusEvents';\n\nexport default {\n  components: {\n    PreChatForm,\n  },\n  mixins: [configMixin, routerMixin],\n  mounted() {\n    bus.$on(ON_CONVERSATION_CREATED, () => {\n      // Redirect to messages page after conversation is created\n      this.replaceRoute('messages');\n    });\n  },\n  methods: {\n    onSubmit({\n      fullName,\n      emailAddress,\n      message,\n      activeCampaignId,\n      phoneNumber,\n      contactCustomAttributes,\n      conversationCustomAttributes,\n    }) {\n      if (activeCampaignId) {\n        bus.$emit('execute-campaign', {\n          campaignId: activeCampaignId,\n          customAttributes: conversationCustomAttributes,\n        });\n        this.$store.dispatch('contacts/update', {\n          user: {\n            email: emailAddress,\n            name: fullName,\n            phone_number: phoneNumber,\n          },\n        });\n      } else {\n        this.$store.dispatch('conversation/createConversation', {\n          fullName: fullName,\n          emailAddress: emailAddress,\n          message: message,\n          phoneNumber: phoneNumber,\n          customAttributes: conversationCustomAttributes,\n        });\n      }\n      if (!isEmptyObject(contactCustomAttributes)) {\n        this.$store.dispatch(\n          'contacts/setCustomAttributes',\n          contactCustomAttributes\n        );\n      }\n    },\n  },\n};\n</script>\n","import { render, staticRenderFns } from \"./PreChatForm.vue?vue&type=template&id=a08096ee&\"\nimport script from \"./PreChatForm.vue?vue&type=script&lang=js&\"\nexport * from \"./PreChatForm.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}