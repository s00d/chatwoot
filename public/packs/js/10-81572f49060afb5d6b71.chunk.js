(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{2538:function(t,e,a){},2539:function(t,e,a){},2540:function(t,e,a){},2541:function(t,e,a){},2542:function(t,e,a){},2543:function(t,e,a){},2544:function(t,e,a){},2581:function(t,e,a){"use strict";a(2538)},2582:function(t,e,a){"use strict";a(2539)},2583:function(t,e,a){"use strict";a(2540)},2584:function(t,e,a){"use strict";a(2541)},2585:function(t,e,a){"use strict";a(2542)},2586:function(t,e,a){"use strict";a(2543)},2587:function(t,e,a){"use strict";a(2544)},2624:function(t,e,a){"use strict";a.r(e);a(38),a(98),a(4),a(51),a(66),a(5),a(2),a(10),a(6),a(11),a(8),a(16),a(25),a(27),a(20),a(24),a(22),a(45),a(44),a(21),a(17),a(312);var n={props:{label:{type:String,required:!0}}},i=(a(2581),a(0)),r=Object(i.a)(n,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"macros-item macros-pill"},[a("span",[t._v(t._s(t.label))])])])}),[],!1,null,"6f9c5e54",null).exports,o=a(323),s=a.n(o),c=(a(29),a(561)),u={props:{type:{type:String,default:"add"},tooltip:{type:String,default:""},icon:{type:String,required:!0}}},l=(a(2582),Object(i.a)(u,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("button",{directives:[{name:"tooltip",rawName:"v-tooltip",value:t.tooltip,expression:"tooltip"}],staticClass:"macros__action-button",class:t.type,on:{click:function(e){return t.$emit("click")}}},[a("fluent-icon",{attrs:{icon:t.icon,"aria-hidden":"true"}})],1)])}),[],!1,null,"0462bb77",null).exports),m={methods:{getDropdownValues:function(t){switch(t){case"assign_team":case"send_email_to_team":return this.teams;case"assign_agent":return this.agents;case"add_label":return this.labels.map((function(t){return{id:t.title,name:t.title}}));default:return[]}}}},d=a(3);function p(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function f(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?p(Object(a),!0).forEach((function(e){_(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):p(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}function _(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}var v={components:{ActionInput:c.a,MacroActionButton:l},mixins:[m],inject:["macroActionTypes","$v"],props:{singleNode:{type:Boolean,default:!1},value:{type:Object,default:function(){return{}}},index:{type:Number,default:0},fileName:{type:String,default:""}},computed:f(f({},Object(d.mapGetters)({labels:"labels/getLabels",teams:"teams/getTeams",agents:"agents/getAgents"})),{},{actionData:{get:function(){return this.value},set:function(t){this.$emit("input",t)}},showActionInput:function(){var t=this;return"send_email_to_team"!==this.actionData.action_name&&"send_message"!==this.actionData.action_name&&!!this.macroActionTypes.find((function(e){return e.key===t.actionData.action_name})).inputType}}),methods:{dropdownValues:function(){return this.getDropdownValues(this.value.action_name,this.$store)},hasError:function(t){return!(!t.action_params.$dirty||!t.action_params.$error)}}},h=(a(2583),Object(i.a)(v,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"macro__node-action-container"},[t.singleNode?t._e():a("fluent-icon",{staticClass:"macros__node-drag-handle",attrs:{size:"20",icon:"navigation"}}),t._v(" "),a("div",{staticClass:"macro__node-action-item",class:{"has-error":t.hasError(t.$v.macro.actions.$each[t.index])}},[a("action-input",{attrs:{"action-types":t.macroActionTypes,"dropdown-values":t.dropdownValues(),"show-action-input":t.showActionInput,"show-remove-button":!1,"is-macro":!0,v:t.$v.macro.actions.$each[t.index],"initial-file-name":t.fileName},on:{resetAction:function(e){return t.$emit("resetAction")}},model:{value:t.actionData,callback:function(e){t.actionData=e},expression:"actionData"}}),t._v(" "),t.singleNode?t._e():a("macro-action-button",{staticClass:"macro__node macro__node-action-button-delete",attrs:{icon:"dismiss-circle",type:"delete",tooltip:t.$t("MACROS.EDITOR.DELETE_BTN_TOOLTIP")},on:{click:function(e){return t.$emit("deleteNode")}}})],1)],1)}),[],!1,null,"37b8a4ea",null).exports),b=a(529),g={components:{Draggable:s.a,MacrosPill:r,MacroNode:h,MacroActionButton:l},props:{value:{type:Array,default:function(){return[]}},files:{type:Array,default:function(){return[]}}},computed:{actionData:{get:function(){return this.value},set:function(t){this.$emit("input",t)}}},methods:{fileName:function(){return b.a.apply(void 0,arguments)}}},O=g,y=(a(2584),Object(i.a)(O,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"macros__nodes"},[a("macros-pill",{staticClass:"macro__node",attrs:{label:t.$t("MACROS.EDITOR.START_FLOW")}}),t._v(" "),a("draggable",{staticClass:"macros__nodes-draggable",attrs:{list:t.actionData,animation:"200","ghost-class":"ghost",tag:"div",handle:".macros__node-drag-handle"}},t._l(t.actionData,(function(e,n){return a("div",{key:n,staticClass:"macro__node"},[a("macro-node",{staticClass:"macros__node-action",attrs:{type:"add",index:n,"file-name":t.fileName(t.actionData[n].action_params[0],t.actionData[n].action_name,t.files),"single-node":1===t.actionData.length},on:{resetAction:function(e){return t.$emit("resetAction",n)},deleteNode:function(e){return t.$emit("deleteNode",n)}},model:{value:t.actionData[n],callback:function(e){t.$set(t.actionData,n,e)},expression:"actionData[i]"}})],1)})),0),t._v(" "),a("macro-action-button",{staticClass:"macro__node",attrs:{icon:"add-circle",tooltip:t.$t("MACROS.EDITOR.ADD_BTN_TOOLTIP"),type:"add"},on:{click:function(e){return t.$emit("addNewNode")}}}),t._v(" "),a("macros-pill",{staticClass:"macro__node",attrs:{label:t.$t("MACROS.EDITOR.END_FLOW")}})],1)}),[],!1,null,"7a0e6f32",null).exports),A={inject:["$v"],props:{macroName:{type:String,default:""},macroVisibility:{type:String,default:"global"}},methods:{isActive:function(t){return{active:this.macroVisibility===t}},onUpdateName:function(t){this.$emit("update:name",t)},onUpdateVisibility:function(t){this.$emit("update:visibility",t)}}},$=(a(2585),Object(i.a)(A,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"macros__properties-panel"},[a("div",[a("woot-input",{class:{error:t.$v.macro.name.$error},attrs:{value:t.macroName,label:t.$t("MACROS.ADD.FORM.NAME.LABEL"),placeholder:t.$t("MACROS.ADD.FORM.NAME.PLACEHOLDER"),error:t.$v.macro.name.$error?t.$t("MACROS.ADD.FORM.NAME.ERROR"):null},on:{input:function(e){return t.onUpdateName(e)}}})],1),t._v(" "),a("div",{staticClass:"macros__form-visibility-container"},[a("p",{staticClass:"title"},[t._v(t._s(t.$t("MACROS.EDITOR.VISIBILITY.LABEL")))]),t._v(" "),a("div",{staticClass:"macros__form-visibility"},[a("button",{staticClass:"card",class:t.isActive("global"),on:{click:function(e){return t.onUpdateVisibility("global")}}},["global"===t.macroVisibility?a("fluent-icon",{staticClass:"visibility-check",attrs:{icon:"checkmark-circle",type:"solid"}}):t._e(),t._v(" "),a("p",{staticClass:"title"},[t._v("\n          "+t._s(t.$t("MACROS.EDITOR.VISIBILITY.GLOBAL.LABEL"))+"\n        ")]),t._v(" "),a("p",{staticClass:"subtitle"},[t._v("\n          "+t._s(t.$t("MACROS.EDITOR.VISIBILITY.GLOBAL.DESCRIPTION"))+"\n        ")])],1),t._v(" "),a("button",{staticClass:"card",class:t.isActive("personal"),on:{click:function(e){return t.onUpdateVisibility("personal")}}},["personal"===t.macroVisibility?a("fluent-icon",{staticClass:"visibility-check",attrs:{icon:"checkmark-circle",type:"solid"}}):t._e(),t._v(" "),a("p",{staticClass:"title"},[t._v("\n          "+t._s(t.$t("MACROS.EDITOR.VISIBILITY.PERSONAL.LABEL"))+"\n        ")]),t._v(" "),a("p",{staticClass:"subtitle"},[t._v("\n          "+t._s(t.$t("MACROS.EDITOR.VISIBILITY.PERSONAL.DESCRIPTION"))+"\n        ")])],1)]),t._v(" "),a("div",{staticClass:"macros__info-panel"},[a("fluent-icon",{attrs:{icon:"info",size:"20"}}),t._v(" "),a("p",[t._v("\n        "+t._s(t.$t("MACROS.ORDER_INFO"))+"\n      ")])],1)]),t._v(" "),a("div",{staticClass:"macros__submit-button"},[a("woot-button",{attrs:{size:"expanded","color-scheme":"success"},on:{click:function(e){return t.$emit("submit")}}},[t._v("\n      "+t._s(t.$t("MACROS.HEADER_BTN_TXT_SAVE"))+"\n    ")])],1)])}),[],!1,null,"4f2a889b",null).exports),D=a(12),E={components:{MacroNodes:y,MacroProperties:$},provide:function(){return{$v:this.$v}},props:{macroData:{type:Object,default:function(){return{}}}},data:function(){return{macro:this.macroData}},computed:{files:function(){return this.macro&&this.macro.files?this.macro.files:[]}},watch:{$route:{handler:function(){this.resetValidation()},immediate:!0},macroData:{handler:function(){this.macro=this.macroData},immediate:!0}},validations:{macro:{name:{required:D.required},visibility:{required:D.required},actions:{required:D.required,$each:{action_params:{required:Object(D.requiredIf)((function(t){return"send_email_to_team"===t.action_name||!("mute_conversation"===t.action_name||"snooze_conversation"===t.action_name||"resolve_conversation"===t.action_name)}))}}}}},methods:{updateName:function(t){this.macro.name=t},updateVisibility:function(t){this.macro.visibility=t},appendNode:function(){this.macro.actions.push({action_name:"assign_team",action_params:[]})},deleteNode:function(t){this.macro.actions.splice(t,1)},submit:function(){this.$v.$touch(),this.$v.$invalid||this.$emit("submit",this.macro)},resetNode:function(t){this.$v.macro.actions.$each[t].$reset(),this.macro.actions[t].action_params=[]},resetValidation:function(){this.$v.$reset()}}},C=(a(2586),Object(i.a)(E,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"row"},[a("div",{staticClass:"small-8 columns with-right-space macros-canvas"},[a("macro-nodes",{attrs:{files:t.files},on:{addNewNode:t.appendNode,deleteNode:t.deleteNode,resetAction:t.resetNode},model:{value:t.macro.actions,callback:function(e){t.$set(t.macro,"actions",e)},expression:"macro.actions"}})],1),t._v(" "),a("div",{staticClass:"small-4 columns"},[a("macro-properties",{attrs:{"macro-name":t.macro.name,"macro-visibility":t.macro.visibility},on:{"update:name":t.updateName,"update:visibility":t.updateVisibility,submit:t.submit}})],1)])}),[],!1,null,"261e1eba",null).exports),I=a(813),w=a(694);function S(t){return function(t){if(Array.isArray(t))return R(t)}(t)||function(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"===typeof t)return R(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);"Object"===a&&t.constructor&&(a=t.constructor.name);if("Map"===a||"Set"===a)return Array.from(t);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return R(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function R(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,n=new Array(e);a<e;a++)n[a]=t[a];return n}function N(t,e,a,n,i,r,o){try{var s=t[r](o),c=s.value}catch(u){return void a(u)}s.done?e(c):Promise.resolve(c).then(n,i)}function T(t){return function(){var e=this,a=arguments;return new Promise((function(n,i){var r=t.apply(e,a);function o(t){N(r,n,i,o,s,"next",t)}function s(t){N(r,n,i,o,s,"throw",t)}o(void 0)}))}}function M(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function j(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?M(Object(a),!0).forEach((function(e){P(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):M(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}function P(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}var L={components:{MacroForm:C},mixins:[a(14).a,m],provide:function(){return{macroActionTypes:this.macroActionTypes}},data:function(){return{macro:null,mode:"CREATE",macroActionTypes:I.a}},computed:j(j({},Object(d.mapGetters)({uiFlags:"macros/getUIFlags",labels:"labels/getLabels",teams:"teams/getTeams",agents:"agents/getAgents"})),{},{macroId:function(){return this.$route.params.macroId}}),watch:{$route:{handler:function(){this.fetchDropdownData(),this.$route.params.macroId?this.fetchMacro():this.initNewMacro()},immediate:!0}},methods:{fetchDropdownData:function(){this.$store.dispatch("agents/get"),this.$store.dispatch("teams/get"),this.$store.dispatch("labels/get")},fetchMacro:function(){this.mode="EDIT",this.manifestMacro()},manifestMacro:function(){var t=this;return T(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$store.dispatch("macros/getSingleMacro",t.macroId);case 2:a=t.$store.getters["macros/getMacro"](t.macroId),t.macro=t.formatMacro(a);case 4:case"end":return e.stop()}}),e)})))()},formatMacro:function(t){var e=this,a=t.actions.map((function(t){var a=[];if(t.action_params.length){var n=e.macroActionTypes.find((function(e){return e.key===t.action_name})).inputType;a="multi_select"===n||"search_select"===n?S(e.getDropdownValues(t.action_name,e.$store)).filter((function(e){return S(t.action_params).includes(e.id)})):"team_message"===n?{team_ids:S(e.getDropdownValues(t.action_name,e.$store)).filter((function(e){return S(t.action_params[0].team_ids).includes(e.id)})),message:t.action_params[0].message}:S(t.action_params)}return j(j({},t),{},{action_params:a})}));return j(j({},t),{},{actions:a})},initNewMacro:function(){this.mode="CREATE",this.macro={name:"",actions:[{action_name:"assign_team",action_params:[]}],visibility:"global"}},saveMacro:function(t){var e=this;return T(regeneratorRuntime.mark((function a(){var n,i,r;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,n="EDIT"===e.mode?"macros/update":"macros/create",i="EDIT"===e.mode?e.$t("MACROS.EDIT.API.SUCCESS_MESSAGE"):e.$t("MACROS.ADD.API.SUCCESS_MESSAGE"),(r=JSON.parse(JSON.stringify(t))).actions=Object(w.a)(r.actions),a.next=7,e.$store.dispatch(n,r);case 7:e.showAlert(i),e.$router.push({name:"macros_wrapper"}),a.next=14;break;case 11:a.prev=11,a.t0=a.catch(0),e.showAlert(e.$t("MACROS.ERROR"));case 14:case"end":return a.stop()}}),a,null,[[0,11]])})))()}}},k=(a(2587),Object(i.a)(L,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"column content-box"},[t.uiFlags.isFetchingItem?a("woot-loading-state",{attrs:{message:t.$t("MACROS.EDITOR.LOADING")}}):t._e(),t._v(" "),t.macro&&!t.uiFlags.isFetchingItem?a("macro-form",{attrs:{"macro-data":t.macro},on:{"update:macroData":function(e){t.macro=e},"update:macro-data":function(e){t.macro=e},submit:t.saveMacro}}):t._e()],1)}),[],!1,null,"48ad5220",null));e.default=k.exports}}]);
//# sourceMappingURL=10-81572f49060afb5d6b71.chunk.js.map