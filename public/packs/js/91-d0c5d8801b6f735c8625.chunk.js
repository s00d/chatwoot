(window.webpackJsonp=window.webpackJsonp||[]).push([[91],{2651:function(t,e,r){"use strict";r(53),r(72),r(43),r(77),r(11),r(7),r(9),r(13),r(10),r(14);var n=r(27),o=r(279);function c(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function s(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?c(Object(r),!0).forEach((function(e){a(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function a(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}e.a={props:{accountSummaryKey:{type:String,default:"getAccountSummary"}},computed:s(s({},Object(n.mapGetters)({accountReport:"getAccountReports"})),{},{accountSummary:function(){return this.$store.getters[this.accountSummaryKey]}}),methods:{calculateTrend:function(t){if(!this.accountSummary.previous[t])return 0;var e=this.accountSummary[t]-this.accountSummary.previous[t];return Math.round(e/this.accountSummary.previous[t]*100)},displayMetric:function(t){return this.isAverageMetricType(t)?Object(o.e)(this.accountSummary[t]):Number(this.accountSummary[t]||"").toLocaleString()},displayInfoText:function(t){if(this.metrics[this.currentSelection].KEY!==t)return"";if(this.isAverageMetricType(t)){var e=this.accountReport.data.map((function(t){return t.count})).reduce((function(t,e){return t+e}),0);return"".concat(this.metrics[this.currentSelection].INFO_TEXT," ").concat(e)}return""},isAverageMetricType:function(t){return["avg_first_response_time","avg_resolution_time","reply_time"].includes(t)}}}},2797:function(t,e,r){"use strict";r(11),r(72),r(43),r(7),r(9),r(13),r(10),r(14);var n=r(2646),o=r(194),c=r(286),s=r(279),a=r(2651),i={mixins:[a.a],props:{metric:{type:Object,default:function(){return{}}}},methods:{trendColor:function(t,e){return this.isAverageMetricType(e)?t>0?"border-red-500 text-red-500":"border-green-500 text-green-500":t<0?"border-red-500 text-red-500":"border-green-500 text-green-500"}}},u=r(6);function l(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function p(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?l(Object(r),!0).forEach((function(e){m(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function m(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var d={components:{ChartStats:Object(u.a)(i,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"text-slate-900 dark:text-slate-100"},[e("span",{staticClass:"text-sm"},[t._v("\n    "+t._s(t.metric.NAME)+"\n  ")]),t._v(" "),e("div",{staticClass:"flex items-end"},[e("div",{staticClass:"font-medium text-xl"},[t._v("\n      "+t._s(t.displayMetric(t.metric.KEY))+"\n    ")]),t._v(" "),t.metric.trend?e("div",{staticClass:"text-xs ml-4 flex items-center mb-0.5"},[t.metric.trend<0?e("div",{staticClass:"h-0 w-0 border-x-4 medium border-x-transparent border-t-[8px] mr-1",class:t.trendColor(t.metric.trend,t.metric.KEY)}):e("div",{staticClass:"h-0 w-0 border-x-4 medium border-x-transparent border-b-[8px] mr-1",class:t.trendColor(t.metric.trend,t.metric.KEY)}),t._v(" "),e("span",{staticClass:"font-medium",class:t.trendColor(t.metric.trend,t.metric.KEY)},[t._v("\n        "+t._s(t.calculateTrend(t.metric.KEY))+"%\n      ")])]):t._e()])])}),[],!1,null,null,null).exports},mixins:[a.a],props:{groupBy:{type:Object,default:function(){return{}}},reportKeys:{type:Object,default:function(){return{CONVERSATIONS:"conversations_count",INCOMING_MESSAGES:"incoming_messages_count",OUTGOING_MESSAGES:"outgoing_messages_count",FIRST_RESPONSE_TIME:"avg_first_response_time",RESOLUTION_TIME:"avg_resolution_time",RESOLUTION_COUNT:"resolutions_count",REPLY_TIME:"reply_time"}}}},computed:{metrics:function(){var t=this,e=Object.keys(this.reportKeys),r={FIRST_RESPONSE_TIME:this.$t("REPORT.METRICS.FIRST_RESPONSE_TIME.INFO_TEXT"),RESOLUTION_TIME:this.$t("REPORT.METRICS.RESOLUTION_TIME.INFO_TEXT")};return e.map((function(e){return{NAME:t.$t("REPORT.METRICS.".concat(e,".NAME")),KEY:t.reportKeys[e],DESC:t.$t("REPORT.METRICS.".concat(e,".DESC")),INFO_TEXT:r[e],TOOLTIP_TEXT:"REPORT.METRICS.".concat(e,".TOOLTIP_TEXT"),trend:t.calculateTrend(t.reportKeys[e])}}))}},methods:{getCollection:function(t){var e=this;if(!this.accountReport.data[t.KEY])return{};var r=this.accountReport.data[t.KEY];return{labels:r.map((function(t){var r,s,a;if((null===(r=e.groupBy)||void 0===r?void 0:r.period)===n.b[2].period){var i=new Date(Object(o.a)(t.timestamp)),u=i.getDate()-i.getDay(),l=u+6,p=new Date(i.setDate(u)),m=new Date(i.setDate(l));return"".concat(Object(c.a)(p,"dd-MMM")," - ").concat(Object(c.a)(m,"dd-MMM"))}return(null===(s=e.groupBy)||void 0===s?void 0:s.period)===n.b[3].period?Object(c.a)(Object(o.a)(t.timestamp),"MMM-yyyy"):(null===(a=e.groupBy)||void 0===a?void 0:a.period)===n.b[4].period?Object(c.a)(Object(o.a)(t.timestamp),"yyyy"):Object(c.a)(Object(o.a)(t.timestamp),"dd-MMM")})),datasets:n.d[t.KEY].datasets.map((function(n){switch(n.type){case"bar":return p(p({},n),{},{yAxisID:"y-left",label:t.NAME,data:r.map((function(t){return t.value}))});case"line":return p(p({},n),{},{yAxisID:"y-right",label:e.metrics[0].NAME,data:r.map((function(t){return t.count}))});default:return n}}))}},getChartOptions:function(t){var e=this,r={};return this.isAverageMetricType(t.KEY)&&(r.callbacks={label:function(r){return e.$t(t.TOOLTIP_TEXT,{metricValue:Object(s.e)(r.yLabel),conversationCount:e.accountReport.data[t.KEY][r.index].count})}}),{scales:n.d[t.KEY].scales,tooltips:r}}}},O=Object(u.a)(d,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 bg-white dark:bg-slate-800 p-2 border border-slate-100 dark:border-slate-700 rounded-md"},t._l(t.metrics,(function(r){return e("div",{key:r.KEY,staticClass:"p-4 rounded-md mb-3"},[e("chart-stats",{attrs:{metric:r,"account-summary-key":t.accountSummaryKey}}),t._v(" "),e("div",{staticClass:"mt-4 h-72"},[t.accountReport.isFetching[r.KEY]?e("woot-loading-state",{staticClass:"text-xs",attrs:{message:t.$t("REPORT.LOADING_CHART")}}):e("div",{staticClass:"h-72 flex items-center justify-center"},[t.accountReport.data[r.KEY].length?e("woot-bar",{staticClass:"h-72 w-full",attrs:{collection:t.getCollection(r),"chart-options":t.getChartOptions(r)}}):e("span",{staticClass:"text-sm text-slate-600"},[t._v("\n          "+t._s(t.$t("REPORT.NO_ENOUGH_DATA"))+"\n        ")])],1)],1)],1)})),0)}),[],!1,null,null,null);e.a=O.exports},3412:function(t,e,r){"use strict";r.r(e);r(11),r(7),r(9),r(13),r(10),r(14),r(8),r(25),r(34);var n=r(27),o=r(194),c=r(286),s=r(2879),a=r(2646),i=r(2651),u=r(78),l=r(87),p=r(2797);function m(t,e,r,n,o,c,s){try{var a=t[c](s),i=a.value}catch(u){return void r(u)}a.done?e(i):Promise.resolve(i).then(n,o)}function d(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function O(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?d(Object(r),!0).forEach((function(e){f(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):d(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function f(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var b={CONVERSATIONS:"conversations_count",INCOMING_MESSAGES:"incoming_messages_count",OUTGOING_MESSAGES:"outgoing_messages_count",FIRST_RESPONSE_TIME:"avg_first_response_time",RESOLUTION_TIME:"avg_resolution_time",RESOLUTION_COUNT:"resolutions_count",REPLY_TIME:"reply_time"},y={name:"ConversationReports",components:{ReportFilterSelector:s.a,ReportContainer:p.a},mixins:[i.a,u.a],data:function(){return{from:0,to:0,groupBy:a.b[1],businessHours:!1}},computed:O({},Object(n.mapGetters)({accountSummary:"getAccountSummary",accountReport:"getAccountReports"})),methods:{fetchAllData:function(){this.fetchAccountSummary(),this.fetchChartData()},fetchAccountSummary:function(){try{this.$store.dispatch("fetchAccountSummary",this.getRequestPayload())}catch(t){this.showAlert(this.$t("REPORT.SUMMARY_FETCHING_FAILED"))}},fetchChartData:function(){var t=this;["CONVERSATIONS","INCOMING_MESSAGES","OUTGOING_MESSAGES","FIRST_RESPONSE_TIME","RESOLUTION_TIME","RESOLUTION_COUNT","REPLY_TIME"].forEach(function(){var e,r=(e=regeneratorRuntime.mark((function e(r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.$store.dispatch("fetchAccountReport",O({metric:b[r]},t.getRequestPayload()));case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),t.showAlert(t.$t("REPORT.DATA_FETCHING_FAILED"));case 8:case"end":return e.stop()}}),e,null,[[0,5]])})),function(){var t=this,r=arguments;return new Promise((function(n,o){var c=e.apply(t,r);function s(t){m(c,n,o,s,a,"next",t)}function a(t){m(c,n,o,s,a,"throw",t)}s(void 0)}))});return function(t){return r.apply(this,arguments)}}())},getRequestPayload:function(){var t=this.from,e=this.to,r=this.groupBy,n=this.businessHours;return{from:t,to:e,groupBy:null===r||void 0===r?void 0:r.period,businessHours:n}},downloadAgentReports:function(){var t=this.from,e=this.to,r="agent-report-".concat(Object(c.a)(Object(o.a)(e),"dd-MM-yyyy"),".csv");this.$store.dispatch("downloadAgentReports",{from:t,to:e,fileName:r})},onFilterChange:function(t){var e=t.from,r=t.to,n=t.groupBy,o=t.businessHours;this.from=e,this.to=r,this.groupBy=n,this.businessHours=o,this.fetchAllData(),this.$track(l.j.FILTER_REPORT,{filterValue:{from:e,to:r,groupBy:n,businessHours:o},reportType:"conversations"})}}},h=y,E=r(6),g=Object(E.a)(h,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"flex-1 overflow-auto p-4"},[e("woot-button",{attrs:{"color-scheme":"success","class-names":"button--fixed-top",icon:"arrow-download"},on:{click:t.downloadAgentReports}},[t._v("\n    "+t._s(t.$t("REPORT.DOWNLOAD_AGENT_REPORTS"))+"\n  ")]),t._v(" "),e("report-filter-selector",{attrs:{"show-agents-filter":!1,"show-group-by-filter":!0},on:{"filter-change":t.onFilterChange}}),t._v(" "),e("report-container",{attrs:{"group-by":t.groupBy}})],1)}),[],!1,null,null,null);e.default=g.exports}}]);
//# sourceMappingURL=91-d0c5d8801b6f735c8625.chunk.js.map