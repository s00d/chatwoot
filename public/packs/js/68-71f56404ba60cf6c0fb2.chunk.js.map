{"version":3,"sources":["webpack:///./app/javascript/shared/helpers/markdownIt/link.js","webpack:///./app/javascript/shared/helpers/MessageFormatter.js","webpack:///./app/javascript/shared/mixins/messageFormatterMixin.js","webpack:///./app/javascript/shared/components/Button.vue?1617","webpack:///./app/javascript/shared/components/Button.vue?26c2","webpack:///app/javascript/shared/components/Button.vue","webpack:///./app/javascript/shared/components/Button.vue","webpack:///./app/javascript/dashboard/mixins/customAttributeMixin.js","webpack:///./app/javascript/widget/components/PreChat/Form.vue?51b1","webpack:///./app/javascript/widget/views/PreChatForm.vue?708e","webpack:///app/javascript/widget/components/PreChat/Form.vue","webpack:///./app/javascript/widget/components/PreChat/Form.vue?3f24","webpack:///./app/javascript/widget/components/PreChat/Form.vue","webpack:///./app/javascript/widget/components/PreChat/Form.vue?e026","webpack:///./app/javascript/widget/views/PreChatForm.vue?fc86","webpack:///app/javascript/widget/views/PreChatForm.vue","webpack:///./app/javascript/widget/views/PreChatForm.vue"],"names":["USER_MENTIONS_REGEX","processInlineToken","blockToken","children","forEach","inlineToken","type","imgSrc","attrGet","height","URL","searchParams","get","attrSet","setImageHeight","md","require","html","xhtmlOut","breaks","langPrefix","linkify","typographer","quotes","maxNesting","use","renderer","rules","mention","tokens","idx","content","inline","ruler","before","state","silent","label","labelEnd","labelStart","pos","res","token","href","max","posMax","src","charCodeAt","helpers","parseLinkLabel","slice","parseLinkDestination","ok","normalizeLink","str","validateLink","match","RegExp","push","core","after","mila","attrs","class","rel","target","TWITTER_USERNAME_REGEX","TWITTER_HASH_REGEX","MessageFormatter","message","isATweet","isAPrivateNote","this","updatedMessage","replace","render","formatMessage","DOMParser","parseFromString","formattedMessage","body","textContent","methods","getPlainText","plainText","truncateMessage","description","length","highlightContent","searchTerm","highlightClass","plainTextContent","escapedSearchTerm","component","_vm","_c","_self","buttonClassName","style","disabled","on","onClick","_t","getRegexp","regexPatternValue","lastSlash","lastIndexOf","staticClass","onSubmit","model","value","callback","$$v","formValues","expression","directives","name","rawName","headerMessage","$dm","_e","_v","_l","item","key","getLabel","getPlaceHolder","getValidation","getOptions","context","labelClass","inputClass","startsWithPlus","$t","isValidPhoneNumber","email","required","matches","regex_cue","hasErrorInPhoneInput","hasActiveCampaign","widgetColor","textColor","isCreating","_s","preChatFormOptions"],"mappings":"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","file":"js/68-71f56404ba60cf6c0fb2.chunk.js","sourcesContent":["// Process [@mention](mention://user/1/Pranav)\nconst USER_MENTIONS_REGEX = /mention:\\/\\/(user|team)\\/(\\d+)\\/(.+)/gm;\n\nconst buildMentionTokens = () => (state, silent) => {\n  var label;\n  var labelEnd;\n  var labelStart;\n  var pos;\n  var res;\n  var token;\n  var href = '';\n  var max = state.posMax;\n\n  if (state.src.charCodeAt(state.pos) !== 0x5b /* [ */) {\n    return false;\n  }\n\n  labelStart = state.pos + 1;\n  labelEnd = state.md.helpers.parseLinkLabel(state, state.pos, true);\n\n  // parser failed to find ']', so it's not a valid link\n  if (labelEnd < 0) {\n    return false;\n  }\n\n  label = state.src.slice(labelStart, labelEnd);\n  pos = labelEnd + 1;\n\n  if (pos < max && state.src.charCodeAt(pos) === 0x28 /* ( */) {\n    pos += 1;\n    res = state.md.helpers.parseLinkDestination(state.src, pos, state.posMax);\n    if (res.ok) {\n      href = state.md.normalizeLink(res.str);\n      if (state.md.validateLink(href)) {\n        pos = res.pos;\n      } else {\n        href = '';\n      }\n    }\n    pos += 1;\n  }\n\n  if (!href.match(new RegExp(USER_MENTIONS_REGEX))) {\n    return false;\n  }\n\n  if (!silent) {\n    state.pos = labelStart;\n    state.posMax = labelEnd;\n\n    token = state.push('mention', '');\n    token.href = href;\n    token.content = label;\n  }\n\n  state.pos = pos;\n  state.posMax = max;\n\n  return true;\n};\n\nconst renderMentions = () => (tokens, idx) => {\n  return `<span class=\"prosemirror-mention-node\">${tokens[idx].content}</span>`;\n};\n\nexport default function mentionPlugin(md) {\n  md.renderer.rules.mention = renderMentions(md);\n  md.inline.ruler.before('link', 'mention', buildMentionTokens(md));\n}\n","import mila from 'markdown-it-link-attributes';\nimport mentionPlugin from './markdownIt/link';\n\nconst setImageHeight = inlineToken => {\n  const imgSrc = inlineToken.attrGet('src');\n  if (!imgSrc) return;\n  const url = new URL(imgSrc);\n  const height = url.searchParams.get('cw_image_height');\n  if (!height) return;\n  inlineToken.attrSet('style', `height: ${height};`);\n};\n\nconst processInlineToken = blockToken => {\n  blockToken.children.forEach(inlineToken => {\n    if (inlineToken.type === 'image') {\n      setImageHeight(inlineToken);\n    }\n  });\n};\n\nconst imgResizeManager = md => {\n  // Custom rule for image resize in markdown\n  // If the image url has a query param cw_image_height, then add a style attribute to the image\n  md.core.ruler.after('inline', 'add-image-height', state => {\n    state.tokens.forEach(blockToken => {\n      if (blockToken.type === 'inline') {\n        processInlineToken(blockToken);\n      }\n    });\n  });\n};\n\nconst md = require('markdown-it')({\n  html: false,\n  xhtmlOut: true,\n  breaks: true,\n  langPrefix: 'language-',\n  linkify: true,\n  typographer: true,\n  quotes: '\\u201c\\u201d\\u2018\\u2019',\n  maxNesting: 20,\n})\n  .use(mentionPlugin)\n  .use(imgResizeManager)\n  .use(mila, {\n    attrs: {\n      class: 'link',\n      rel: 'noreferrer noopener nofollow',\n      target: '_blank',\n    },\n  });\n\nconst TWITTER_USERNAME_REGEX = /(^|[^@\\w])@(\\w{1,15})\\b/g;\nconst TWITTER_USERNAME_REPLACEMENT = '$1[@$2](http://twitter.com/$2)';\nconst TWITTER_HASH_REGEX = /(^|\\s)#(\\w+)/g;\nconst TWITTER_HASH_REPLACEMENT = '$1[#$2](https://twitter.com/hashtag/$2)';\n\nclass MessageFormatter {\n  constructor(message, isATweet = false, isAPrivateNote = false) {\n    this.message = message || '';\n    this.isAPrivateNote = isAPrivateNote;\n    this.isATweet = isATweet;\n  }\n\n  formatMessage() {\n    let updatedMessage = this.message;\n    if (this.isATweet && !this.isAPrivateNote) {\n      updatedMessage = updatedMessage.replace(\n        TWITTER_USERNAME_REGEX,\n        TWITTER_USERNAME_REPLACEMENT\n      );\n      updatedMessage = updatedMessage.replace(\n        TWITTER_HASH_REGEX,\n        TWITTER_HASH_REPLACEMENT\n      );\n    }\n    return md.render(updatedMessage);\n  }\n\n  get formattedMessage() {\n    return this.formatMessage();\n  }\n\n  get plainText() {\n    const strippedOutHtml = new DOMParser().parseFromString(\n      this.formattedMessage,\n      'text/html'\n    );\n    return strippedOutHtml.body.textContent || '';\n  }\n}\n\nexport default MessageFormatter;\n","import MessageFormatter from '../helpers/MessageFormatter';\n\nexport default {\n  methods: {\n    formatMessage(message, isATweet, isAPrivateNote) {\n      const messageFormatter = new MessageFormatter(\n        message,\n        isATweet,\n        isAPrivateNote\n      );\n      return messageFormatter.formattedMessage;\n    },\n    getPlainText(message, isATweet) {\n      const messageFormatter = new MessageFormatter(message, isATweet);\n      return messageFormatter.plainText;\n    },\n    truncateMessage(description = '') {\n      if (description.length < 100) {\n        return description;\n      }\n\n      return `${description.slice(0, 97)}...`;\n    },\n\n    highlightContent(content = '', searchTerm = '', highlightClass = '') {\n      const plainTextContent = this.getPlainText(content);\n\n      // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions#escaping\n      const escapedSearchTerm = searchTerm.replace(\n        /[.*+?^${}()|[\\]\\\\]/g,\n        '\\\\$&'\n      );\n\n      return plainTextContent.replace(\n        new RegExp(`(${escapedSearchTerm})`, 'ig'),\n        `<span class=\"${highlightClass}\">$1</span>`\n      );\n    },\n  },\n};\n","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('button',{class:_vm.buttonClassName,style:(_vm.buttonStyles),attrs:{\"disabled\":_vm.disabled},on:{\"click\":_vm.onClick}},[_vm._t(\"default\")],2)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import mod from \"-!../../../../node_modules/babel-loader/lib/index.js??ref--7-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Button.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/babel-loader/lib/index.js??ref--7-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Button.vue?vue&type=script&lang=js&\"","<template>\n  <button\n    :class=\"buttonClassName\"\n    :style=\"buttonStyles\"\n    :disabled=\"disabled\"\n    @click=\"onClick\"\n  >\n    <slot />\n  </button>\n</template>\n<script>\nexport default {\n  props: {\n    block: {\n      type: Boolean,\n      default: false,\n    },\n    type: {\n      type: String,\n      default: 'blue',\n    },\n    bgColor: {\n      type: String,\n      default: '',\n    },\n    textColor: {\n      type: String,\n      default: '',\n    },\n    disabled: {\n      type: Boolean,\n      default: false,\n    },\n  },\n  computed: {\n    buttonClassName() {\n      let className = 'text-white py-3 px-4 rounded shadow-sm leading-4';\n      if (this.type === 'clear') {\n        className = 'flex mx-auto mt-4 text-xs leading-3 w-auto text-black-600';\n      }\n\n      if (this.type === 'blue' && !Object.keys(this.buttonStyles).length) {\n        className = `${className} bg-woot-500 hover:bg-woot-700`;\n      }\n      if (this.block) {\n        className = `${className} w-full`;\n      }\n      return className;\n    },\n    buttonStyles() {\n      const styles = {};\n      if (this.bgColor) {\n        styles.backgroundColor = this.bgColor;\n      }\n      if (this.textColor) {\n        styles.color = this.textColor;\n      }\n      return styles;\n    },\n  },\n  methods: {\n    onClick(e) {\n      this.$emit('click', e);\n    },\n  },\n};\n</script>\n","import { render, staticRenderFns } from \"./Button.vue?vue&type=template&id=05075a0e&\"\nimport script from \"./Button.vue?vue&type=script&lang=js&\"\nexport * from \"./Button.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","export default {\n  methods: {\n    getRegexp(regexPatternValue) {\n      let lastSlash = regexPatternValue.lastIndexOf('/');\n      return new RegExp(\n        regexPatternValue.slice(1, lastSlash),\n        regexPatternValue.slice(lastSlash + 1)\n      );\n    },\n  },\n};\n","export * from \"-!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js!../../../../../node_modules/css-loader/dist/cjs.js??ref--3-1!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/postcss-loader/dist/cjs.js??ref--3-2!../../../../../node_modules/sass-loader/dist/cjs.js??ref--3-3!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Form.vue?vue&type=style&index=0&id=be741956&prod&lang=scss&scoped=true&\"","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"flex flex-1 overflow-auto\"},[_c('pre-chat-form',{attrs:{\"options\":_vm.preChatFormOptions},on:{\"submit\":_vm.onSubmit}})],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <FormulateForm\n    v-model=\"formValues\"\n    class=\"flex flex-col flex-1 p-6 overflow-y-auto\"\n    @submit=\"onSubmit\"\n  >\n    <div\n      v-if=\"shouldShowHeaderMessage\"\n      v-dompurify-html=\"formatMessage(headerMessage, false)\"\n      class=\"mb-4 text-sm leading-5 pre-chat-header-message\"\n      :class=\"$dm('text-black-800', 'dark:text-slate-50')\"\n    />\n    <FormulateInput\n      v-for=\"item in enabledPreChatFields\"\n      :key=\"item.name\"\n      :name=\"item.name\"\n      :type=\"item.type\"\n      :label=\"getLabel(item)\"\n      :placeholder=\"getPlaceHolder(item)\"\n      :validation=\"getValidation(item)\"\n      :options=\"getOptions(item)\"\n      :label-class=\"context => labelClass(context)\"\n      :input-class=\"context => inputClass(context)\"\n      :validation-messages=\"{\n        startsWithPlus: $t(\n          'PRE_CHAT_FORM.FIELDS.PHONE_NUMBER.DIAL_CODE_VALID_ERROR'\n        ),\n        isValidPhoneNumber: $t('PRE_CHAT_FORM.FIELDS.PHONE_NUMBER.VALID_ERROR'),\n        email: $t('PRE_CHAT_FORM.FIELDS.EMAIL_ADDRESS.VALID_ERROR'),\n        required: $t('PRE_CHAT_FORM.REQUIRED'),\n        matches: item.regex_cue\n          ? item.regex_cue\n          : $t('PRE_CHAT_FORM.REGEX_ERROR'),\n      }\"\n      :has-error-in-phone-input=\"hasErrorInPhoneInput\"\n    />\n    <FormulateInput\n      v-if=\"!hasActiveCampaign\"\n      name=\"message\"\n      type=\"textarea\"\n      :label-class=\"context => labelClass(context)\"\n      :input-class=\"context => inputClass(context)\"\n      :label=\"$t('PRE_CHAT_FORM.FIELDS.MESSAGE.LABEL')\"\n      :placeholder=\"$t('PRE_CHAT_FORM.FIELDS.MESSAGE.PLACEHOLDER')\"\n      validation=\"required\"\n      :validation-messages=\"{\n        required: $t('PRE_CHAT_FORM.FIELDS.MESSAGE.ERROR'),\n      }\"\n    />\n\n    <custom-button\n      class=\"mt-2 mb-5 font-medium\"\n      block\n      :bg-color=\"widgetColor\"\n      :text-color=\"textColor\"\n      :disabled=\"isCreating\"\n    >\n      <spinner v-if=\"isCreating\" class=\"p-0\" />\n      {{ $t('START_CONVERSATION') }}\n    </custom-button>\n  </FormulateForm>\n</template>\n\n<script>\nimport CustomButton from 'shared/components/Button.vue';\nimport Spinner from 'shared/components/Spinner.vue';\nimport { mapGetters } from 'vuex';\nimport { getContrastingTextColor } from '@chatwoot/utils';\nimport messageFormatterMixin from 'shared/mixins/messageFormatterMixin';\nimport { isEmptyObject } from 'widget/helpers/utils';\nimport routerMixin from 'widget/mixins/routerMixin';\nimport darkModeMixin from 'widget/mixins/darkModeMixin';\nimport configMixin from 'widget/mixins/configMixin';\nimport customAttributeMixin from '../../../dashboard/mixins/customAttributeMixin';\n\nexport default {\n  components: {\n    CustomButton,\n    Spinner,\n  },\n  mixins: [\n    routerMixin,\n    darkModeMixin,\n    messageFormatterMixin,\n    configMixin,\n    customAttributeMixin,\n  ],\n  props: {\n    options: {\n      type: Object,\n      default: () => {},\n    },\n  },\n  data() {\n    return {\n      locale: this.$root.$i18n.locale,\n      hasErrorInPhoneInput: false,\n      message: '',\n      formValues: {},\n      labels: {\n        emailAddress: 'EMAIL_ADDRESS',\n        fullName: 'FULL_NAME',\n        phoneNumber: 'PHONE_NUMBER',\n      },\n    };\n  },\n  computed: {\n    ...mapGetters({\n      widgetColor: 'appConfig/getWidgetColor',\n      isCreating: 'conversation/getIsCreating',\n      activeCampaign: 'campaign/getActiveCampaign',\n      currentUser: 'contacts/getCurrentUser',\n    }),\n    textColor() {\n      return getContrastingTextColor(this.widgetColor);\n    },\n    hasActiveCampaign() {\n      return !isEmptyObject(this.activeCampaign);\n    },\n    shouldShowHeaderMessage() {\n      return this.hasActiveCampaign || this.preChatFormEnabled;\n    },\n    headerMessage() {\n      if (this.preChatFormEnabled) {\n        return this.options.preChatMessage;\n      }\n      if (this.hasActiveCampaign) {\n        return this.$t('PRE_CHAT_FORM.CAMPAIGN_HEADER');\n      }\n      return '';\n    },\n    preChatFields() {\n      return this.preChatFormEnabled ? this.options.preChatFields : [];\n    },\n    filteredPreChatFields() {\n      const isUserEmailAvailable = this.currentUser.has_email;\n      const isUserPhoneNumberAvailable = this.currentUser.has_phone_number;\n      const isUserIdentifierAvailable = !!this.currentUser.identifier;\n\n      const isUserNameAvailable = !!(\n        isUserIdentifierAvailable ||\n        isUserEmailAvailable ||\n        isUserPhoneNumberAvailable\n      );\n      return this.preChatFields.filter(field => {\n        if (isUserEmailAvailable && field.name === 'emailAddress') {\n          return false;\n        }\n        if (isUserPhoneNumberAvailable && field.name === 'phoneNumber') {\n          return false;\n        }\n        if (isUserNameAvailable && field.name === 'fullName') {\n          return false;\n        }\n        return true;\n      });\n    },\n    enabledPreChatFields() {\n      return this.filteredPreChatFields\n        .filter(field => field.enabled)\n        .map(field => ({\n          ...field,\n          type:\n            field.name === 'phoneNumber'\n              ? 'phoneInput'\n              : this.findFieldType(field.type),\n        }));\n    },\n    conversationCustomAttributes() {\n      let conversationAttributes = {};\n      this.enabledPreChatFields.forEach(field => {\n        if (field.field_type === 'conversation_attribute') {\n          conversationAttributes = {\n            ...conversationAttributes,\n            [field.name]: this.getValue(field),\n          };\n        }\n      });\n      return conversationAttributes;\n    },\n    contactCustomAttributes() {\n      let contactAttributes = {};\n      this.enabledPreChatFields.forEach(field => {\n        if (field.field_type === 'contact_attribute') {\n          contactAttributes = {\n            ...contactAttributes,\n            [field.name]: this.getValue(field),\n          };\n        }\n      });\n      return contactAttributes;\n    },\n    inputStyles() {\n      return `mt-1 border rounded w-full py-2 px-3 text-slate-700 outline-none`;\n    },\n    isInputDarkOrLightMode() {\n      return `${this.$dm('bg-white', 'dark:bg-slate-600')} ${this.$dm(\n        'text-slate-700',\n        'dark:text-slate-50'\n      )}`;\n    },\n    inputBorderColor() {\n      return `${this.$dm('border-black-200', 'dark:border-black-500')}`;\n    },\n  },\n  methods: {\n    labelClass(context) {\n      const { hasErrors } = context;\n      if (!hasErrors) {\n        return `text-xs font-medium ${this.$dm(\n          'text-black-800',\n          'dark:text-slate-50'\n        )}`;\n      }\n      return `text-xs font-medium ${this.$dm(\n        'text-red-400',\n        'dark:text-red-400'\n      )}`;\n    },\n    inputClass(context) {\n      const { hasErrors, classification, type } = context;\n      if (classification === 'box' && type === 'checkbox') {\n        return '';\n      }\n      if (type === 'phoneInput') {\n        this.hasErrorInPhoneInput = hasErrors;\n      }\n      if (!hasErrors) {\n        return `${this.inputStyles} hover:border-black-300 focus:border-black-300 ${this.isInputDarkOrLightMode} ${this.inputBorderColor}`;\n      }\n      return `${this.inputStyles} border-red-200 hover:border-red-300 focus:border-red-300 ${this.isInputDarkOrLightMode}`;\n    },\n    isContactFieldRequired(field) {\n      return this.preChatFields.find(option => option.name === field).required;\n    },\n    getLabel({ label }) {\n      return label;\n    },\n    getPlaceHolder({ placeholder }) {\n      return placeholder;\n    },\n    getValue({ name, type }) {\n      if (type === 'select') {\n        return this.enabledPreChatFields.find(option => option.name === name)\n          .values[this.formValues[name]];\n      }\n      return this.formValues[name] || null;\n    },\n    getValidation({ type, name, field_type, regex_pattern }) {\n      let regex = regex_pattern ? this.getRegexp(regex_pattern) : null;\n      const validations = {\n        emailAddress: 'email',\n        phoneNumber: ['startsWithPlus', 'isValidPhoneNumber'],\n        url: 'url',\n        date: 'date',\n        text: null,\n        select: null,\n        number: null,\n        checkbox: false,\n        contact_attribute: regex ? [['matches', regex]] : null,\n        conversation_attribute: regex ? [['matches', regex]] : null,\n      };\n      const validationKeys = Object.keys(validations);\n      const isRequired = this.isContactFieldRequired(name);\n      const validation = isRequired\n        ? ['bail', 'required']\n        : ['bail', 'optional'];\n\n      if (\n        validationKeys.includes(name) ||\n        validationKeys.includes(type) ||\n        validationKeys.includes(field_type)\n      ) {\n        const validationType =\n          validations[type] || validations[name] || validations[field_type];\n        return validationType ? validation.concat(validationType) : validation;\n      }\n\n      return [];\n    },\n    findFieldType(type) {\n      if (type === 'link') {\n        return 'url';\n      }\n      if (type === 'list') {\n        return 'select';\n      }\n\n      return type;\n    },\n    getOptions(item) {\n      if (item.type === 'select') {\n        let values = {};\n        item.values.forEach((value, index) => {\n          values = {\n            ...values,\n            [index]: value,\n          };\n        });\n        return values;\n      }\n      return null;\n    },\n    onSubmit() {\n      const { emailAddress, fullName, phoneNumber, message } = this.formValues;\n      this.$emit('submit', {\n        fullName,\n        phoneNumber,\n        emailAddress,\n        message,\n        activeCampaignId: this.activeCampaign.id,\n        conversationCustomAttributes: this.conversationCustomAttributes,\n        contactCustomAttributes: this.contactCustomAttributes,\n      });\n    },\n  },\n};\n</script>\n<style lang=\"scss\" scoped>\n@import '~widget/assets/scss/variables.scss';\n::v-deep {\n  .wrapper[data-type='checkbox'] {\n    .formulate-input-wrapper {\n      display: flex;\n      align-items: center;\n      line-height: $space-normal;\n\n      label {\n        margin-left: 0.2rem;\n      }\n    }\n  }\n  @media (prefers-color-scheme: dark) {\n    .wrapper {\n      .formulate-input-element--date,\n      .formulate-input-element--checkbox {\n        input {\n          color-scheme: dark;\n        }\n      }\n    }\n  }\n  .wrapper[data-type='textarea'] {\n    .formulate-input-element--textarea {\n      textarea {\n        min-height: 8rem;\n      }\n    }\n  }\n  .pre-chat-header-message {\n    .link {\n      color: $color-woot;\n      text-decoration: underline;\n    }\n  }\n}\n</style>\n","import mod from \"-!../../../../../node_modules/babel-loader/lib/index.js??ref--7-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Form.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../node_modules/babel-loader/lib/index.js??ref--7-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Form.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Form.vue?vue&type=template&id=be741956&scoped=true&\"\nimport script from \"./Form.vue?vue&type=script&lang=js&\"\nexport * from \"./Form.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Form.vue?vue&type=style&index=0&id=be741956&prod&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"be741956\",\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('FormulateForm',{staticClass:\"flex flex-col flex-1 p-6 overflow-y-auto\",on:{\"submit\":_vm.onSubmit},model:{value:(_vm.formValues),callback:function ($$v) {_vm.formValues=$$v},expression:\"formValues\"}},[(_vm.shouldShowHeaderMessage)?_c('div',{directives:[{name:\"dompurify-html\",rawName:\"v-dompurify-html\",value:(_vm.formatMessage(_vm.headerMessage, false)),expression:\"formatMessage(headerMessage, false)\"}],staticClass:\"mb-4 text-sm leading-5 pre-chat-header-message\",class:_vm.$dm('text-black-800', 'dark:text-slate-50')}):_vm._e(),_vm._v(\" \"),_vm._l((_vm.enabledPreChatFields),function(item){return _c('FormulateInput',{key:item.name,attrs:{\"name\":item.name,\"type\":item.type,\"label\":_vm.getLabel(item),\"placeholder\":_vm.getPlaceHolder(item),\"validation\":_vm.getValidation(item),\"options\":_vm.getOptions(item),\"label-class\":context => _vm.labelClass(context),\"input-class\":context => _vm.inputClass(context),\"validation-messages\":{\n      startsWithPlus: _vm.$t(\n        'PRE_CHAT_FORM.FIELDS.PHONE_NUMBER.DIAL_CODE_VALID_ERROR'\n      ),\n      isValidPhoneNumber: _vm.$t('PRE_CHAT_FORM.FIELDS.PHONE_NUMBER.VALID_ERROR'),\n      email: _vm.$t('PRE_CHAT_FORM.FIELDS.EMAIL_ADDRESS.VALID_ERROR'),\n      required: _vm.$t('PRE_CHAT_FORM.REQUIRED'),\n      matches: item.regex_cue\n        ? item.regex_cue\n        : _vm.$t('PRE_CHAT_FORM.REGEX_ERROR'),\n    },\"has-error-in-phone-input\":_vm.hasErrorInPhoneInput}})}),_vm._v(\" \"),(!_vm.hasActiveCampaign)?_c('FormulateInput',{attrs:{\"name\":\"message\",\"type\":\"textarea\",\"label-class\":context => _vm.labelClass(context),\"input-class\":context => _vm.inputClass(context),\"label\":_vm.$t('PRE_CHAT_FORM.FIELDS.MESSAGE.LABEL'),\"placeholder\":_vm.$t('PRE_CHAT_FORM.FIELDS.MESSAGE.PLACEHOLDER'),\"validation\":\"required\",\"validation-messages\":{\n      required: _vm.$t('PRE_CHAT_FORM.FIELDS.MESSAGE.ERROR'),\n    }}}):_vm._e(),_vm._v(\" \"),_c('custom-button',{staticClass:\"mt-2 mb-5 font-medium\",attrs:{\"block\":\"\",\"bg-color\":_vm.widgetColor,\"text-color\":_vm.textColor,\"disabled\":_vm.isCreating}},[(_vm.isCreating)?_c('spinner',{staticClass:\"p-0\"}):_vm._e(),_vm._v(\"\\n    \"+_vm._s(_vm.$t('START_CONVERSATION'))+\"\\n  \")],1)],2)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import mod from \"-!../../../../node_modules/babel-loader/lib/index.js??ref--7-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PreChatForm.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/babel-loader/lib/index.js??ref--7-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PreChatForm.vue?vue&type=script&lang=js&\"","<template>\n  <div class=\"flex flex-1 overflow-auto\">\n    <pre-chat-form :options=\"preChatFormOptions\" @submit=\"onSubmit\" />\n  </div>\n</template>\n<script>\nimport PreChatForm from '../components/PreChat/Form.vue';\nimport configMixin from '../mixins/configMixin';\nimport routerMixin from '../mixins/routerMixin';\nimport { isEmptyObject } from 'widget/helpers/utils';\nimport { ON_CONVERSATION_CREATED } from '../constants/widgetBusEvents';\n\nexport default {\n  components: {\n    PreChatForm,\n  },\n  mixins: [configMixin, routerMixin],\n  mounted() {\n    bus.$on(ON_CONVERSATION_CREATED, () => {\n      // Redirect to messages page after conversation is created\n      this.replaceRoute('messages');\n    });\n  },\n  methods: {\n    onSubmit({\n      fullName,\n      emailAddress,\n      message,\n      activeCampaignId,\n      phoneNumber,\n      contactCustomAttributes,\n      conversationCustomAttributes,\n    }) {\n      if (activeCampaignId) {\n        bus.$emit('execute-campaign', {\n          campaignId: activeCampaignId,\n          customAttributes: conversationCustomAttributes,\n        });\n        this.$store.dispatch('contacts/update', {\n          user: {\n            email: emailAddress,\n            name: fullName,\n            phone_number: phoneNumber,\n          },\n        });\n      } else {\n        this.$store.dispatch('conversation/createConversation', {\n          fullName: fullName,\n          emailAddress: emailAddress,\n          message: message,\n          phoneNumber: phoneNumber,\n          customAttributes: conversationCustomAttributes,\n        });\n      }\n      if (!isEmptyObject(contactCustomAttributes)) {\n        this.$store.dispatch(\n          'contacts/setCustomAttributes',\n          contactCustomAttributes\n        );\n      }\n    },\n  },\n};\n</script>\n","import { render, staticRenderFns } from \"./PreChatForm.vue?vue&type=template&id=a08096ee&\"\nimport script from \"./PreChatForm.vue?vue&type=script&lang=js&\"\nexport * from \"./PreChatForm.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}