(window.webpackJsonp=window.webpackJsonp||[]).push([[30],{144:function(t,e,r){"use strict";r.d(e,"a",(function(){return n})),r.d(e,"b",(function(){return o})),r.d(e,"c",(function(){return a})),r.d(e,"d",(function(){return c})),r.d(e,"e",(function(){return s})),r.d(e,"f",(function(){return i}));var n=function(t,e,r){var n;return function(){var a=null,o=arguments,i=function(){n=null,r||t.apply(a,o)},s=r&&!n;clearTimeout(n),n=window.setTimeout(i,e),s&&t.apply(a,o)}},a=function(t){var e=t.replace("#","");return.299*parseInt(e.slice(0,2),16)+.587*parseInt(e.slice(2,4),16)+.114*parseInt(e.slice(4,6),16)>186?"#000000":"#FFFFFF"},o=function(t){var e="";if(t>=60&&t<3600){var r=Math.floor(t/60);e=r+" Min";var n=60===r?0:Math.floor(t%60);return e+(n>0?" "+n+" Sec":"")}if(t>=3600&&t<86400){var a=Math.floor(t/3600);e=a+" Hr";var o=t%3600<60||24===a?0:Math.floor(t%3600/60);return e+(o>0?" "+o+" Min":"")}if(t>=86400){var i=Math.floor(t/86400);e=i+" Day";var s=t%86400<3600||i>=364?0:Math.floor(t%86400/3600);return e+(s>0?" "+s+" Hr":"")}return Math.floor(t)+" Sec"},i=function(t,e,r){void 0===t&&(t=""),void 0===e&&(e=1024),void 0===r&&(r=!1);var n=t;return t.length>e&&(n=t.substring(0,e)),r&&(n+="..."),n};function s(t){try{var e=String(t).toLowerCase();return Boolean(JSON.parse(e))}catch(r){return!1}}function u(t){return t.slice().sort((function(t,e){return t-e}))}function l(t,e){var r,n,a,o=(n=1,(a=e)<(r=0)?r:a>n?n:a),i=(t.length-1)*o,s=Math.floor(i),u=i-s;return void 0!==t[s+1]?t[s]+u*(t[s+1]-t[s]):t[s]}var c=function(t,e){var r=u(t);return e.map((function(t){return l(r,t)}))}},149:function(t,e,r){"use strict";r(44),r(47),r(67);var n=r(670),a=r.n(n),o=(r(288),r(617),r(153),/mention:\/\/(user|team)\/(\d+)\/(.+)/gm);function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var u=r(366)({html:!1,xhtmlOut:!0,breaks:!0,langPrefix:"language-",linkify:!0,typographer:!0,quotes:"\u201c\u201d\u2018\u2019",maxNesting:20}).use((function(t){t.renderer.rules.mention=function(t,e){return'<span class="prosemirror-mention-node">'.concat(t[e].content,"</span>")},t.inline.ruler.before("link","mention",(function(t,e){var r,n,a,i,s,u,l="",c=t.posMax;return 91===t.src.charCodeAt(t.pos)&&(a=t.pos+1,!((n=t.md.helpers.parseLinkLabel(t,t.pos,!0))<0)&&(r=t.src.slice(a,n),(i=n+1)<c&&40===t.src.charCodeAt(i)&&(i+=1,(s=t.md.helpers.parseLinkDestination(t.src,i,t.posMax)).ok&&(l=t.md.normalizeLink(s.str),t.md.validateLink(l)?i=s.pos:l=""),i+=1),!!l.match(new RegExp(o))&&(e||(t.pos=a,t.posMax=n,(u=t.push("mention","")).href=l,u.content=r),t.pos=i,t.posMax=c,!0)))}))})).use(a.a,{attrs:{class:"link",rel:"noreferrer noopener nofollow",target:"_blank"}}),l=/(^|[^@\w])@(\w{1,15})\b/g,c=/(^|\s)#(\w+)/g,d=function(){function t(e){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];i(this,t),this.message=e||"",this.isAPrivateNote=n,this.isATweet=r}var e,r,n;return e=t,(r=[{key:"formatMessage",value:function(){var t=this.message;return this.isATweet&&!this.isAPrivateNote&&(t=(t=t.replace(l,"$1[@$2](http://twitter.com/$2)")).replace(c,"$1[#$2](https://twitter.com/hashtag/$2)")),u.render(t)}},{key:"formattedMessage",get:function(){return this.formatMessage()}},{key:"plainText",get:function(){return(new DOMParser).parseFromString(this.formattedMessage,"text/html").body.textContent||""}}])&&s(e.prototype,r),n&&s(e,n),t}(),f=d;e.a={methods:{formatMessage:function(t,e,r){return new f(t,e,r).formattedMessage},getPlainText:function(t,e){return new f(t,e).plainText},truncateMessage:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return t.length<100?t:"".concat(t.slice(0,97),"...")}}}},2846:function(t,e,r){},2997:function(t,e,r){"use strict";r(2846)},3029:function(t,e,r){"use strict";r.r(e);r(7),r(3),r(5),r(9),r(8),r(10);var n=r(4),a=(r(22),r(40),r(30),r(106),r(21),r(6),r(23),r(53),r(68),r(665)),o=r(66),i=r(144),s=r(149),u=r(87),l=r(576),c=r(265);function d(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function f(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?d(Object(r),!0).forEach((function(e){p(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):d(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function p(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var m={components:{CustomButton:a.a,Spinner:o.a},mixins:[l.a,c.a,s.a],props:{options:{type:Object,default:function(){}},disableContactFields:{type:Boolean,default:!1}},data:function(){return{locale:this.$root.$i18n.locale,message:"",formValues:{},labels:{emailAddress:"EMAIL_ADDRESS",fullName:"FULL_NAME",phoneNumber:"PHONE_NUMBER"}}},computed:f(f({},Object(n.mapGetters)({widgetColor:"appConfig/getWidgetColor",isCreating:"conversation/getIsCreating",activeCampaign:"campaign/getActiveCampaign",currentUser:"contacts/getCurrentUser"})),{},{textColor:function(){return Object(i.c)(this.widgetColor)},hasActiveCampaign:function(){return!Object(u.d)(this.activeCampaign)},shouldShowHeaderMessage:function(){return this.hasActiveCampaign||this.options.preChatMessage},headerMessage:function(){return this.hasActiveCampaign?this.$t("PRE_CHAT_FORM.CAMPAIGN_HEADER"):this.options.preChatMessage},preChatFields:function(){return this.disableContactFields?[]:this.options.preChatFields},filteredPreChatFields:function(){var t=!!this.currentUser.email,e=!!this.currentUser.phone_number,r=!!(!!this.currentUser.identifier||t||e);return this.preChatFields.filter((function(n){return(!t||"emailAddress"!==n.name)&&((!e||"phoneNumber"!==n.name)&&(!r||"fullName"!==n.name))}))},enabledPreChatFields:function(){var t=this;return this.filteredPreChatFields.filter((function(t){return t.enabled})).map((function(e){return f(f({},e),{},{type:t.findFieldType(e.type)})}))},conversationCustomAttributes:function(){var t=this,e={};return this.enabledPreChatFields.forEach((function(r){"conversation_attribute"===r.field_type&&(e=f(f({},e),{},p({},r.name,t.getValue(r))))})),e},contactCustomAttributes:function(){var t=this,e={};return this.enabledPreChatFields.forEach((function(r){"contact_attribute"===r.field_type&&(e=f(f({},e),{},p({},r.name,t.getValue(r))))})),e},inputStyles:function(){return"mt-2 border rounded w-full py-2 px-3 text-slate-700 outline-none"},isInputDarkOrLightMode:function(){return"".concat(this.$dm("bg-white","dark:bg-slate-600")," ").concat(this.$dm("text-slate-700","dark:text-slate-50"))},inputBorderColor:function(){return"".concat(this.$dm("border-black-200","dark:border-black-500"))}}),methods:{labelClass:function(t){var e=t.hasErrors;return"text-xs font-medium ".concat(e?this.$dm("text-red-400","dark:text-red-400"):this.$dm("text-black-800","dark:text-slate-50"))},inputClass:function(t){var e=t.hasErrors,r=t.classification,n=t.type;return"box"===r&&"checkbox"===n?"":e?"".concat(this.inputStyles," border-red-200 hover:border-red-300 focus:border-red-300 ").concat(this.isInputDarkOrLightMode):"".concat(this.inputStyles," hover:border-black-300 focus:border-black-300 ").concat(this.isInputDarkOrLightMode," ").concat(this.inputBorderColor)},isContactFieldRequired:function(t){return this.preChatFields.find((function(e){return e.name===t})).required},getLabel:function(t){return t.label},getPlaceHolder:function(t){return t.placeholder},getValue:function(t){var e=t.name;return"select"===t.type?this.enabledPreChatFields.find((function(t){return t.name===e})).values[this.formValues[e]]:this.formValues[e]||null},getValidation:function(t){var e=t.type,r=t.name;if(!this.isContactFieldRequired(r))return"";var n={emailAddress:"email",phoneNumber:"isPhoneE164OrEmpty",url:"url",date:"date",text:null,select:null,number:null,checkbox:!1},a=Object.keys(n),o="bail|required";if(a.includes(r)||a.includes(e)){var i=n[e]||n[r];return i?"".concat(o,"|").concat(i):o}return""},findFieldType:function(t){return"link"===t?"url":"list"===t?"select":t},getOptions:function(t){if("select"===t.type){var e={};return t.values.forEach((function(t,r){e=f(f({},e),{},p({},r,t))})),e}return null},onSubmit:function(){var t=this.formValues,e=t.emailAddress,r=t.fullName,n=t.phoneNumber,a=t.message,o=this.currentUser.email;this.$emit("submit",{fullName:r,phoneNumber:n,emailAddress:e||o,message:a,activeCampaignId:this.activeCampaign.id,conversationCustomAttributes:this.conversationCustomAttributes,contactCustomAttributes:this.contactCustomAttributes})}}},h=(r(2997),r(1));function b(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function g(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?b(Object(r),!0).forEach((function(e){v(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):b(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function v(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var C={components:{PreChatForm:Object(h.a)(m,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("FormulateForm",{staticClass:"flex flex-1 flex-col p-6 overflow-y-auto",on:{submit:t.onSubmit},model:{value:t.formValues,callback:function(e){t.formValues=e},expression:"formValues"}},[t.shouldShowHeaderMessage?r("div",{directives:[{name:"dompurify-html",rawName:"v-dompurify-html",value:t.formatMessage(t.headerMessage,!1),expression:"formatMessage(headerMessage, false)"}],staticClass:"mb-4 text-sm leading-5 pre-chat-header-message",class:t.$dm("text-black-800","dark:text-slate-50")}):t._e(),t._v(" "),t._l(t.enabledPreChatFields,(function(e){return r("FormulateInput",{key:e.name,attrs:{name:e.name,type:e.type,label:t.getLabel(e),placeholder:t.getPlaceHolder(e),validation:t.getValidation(e),options:t.getOptions(e),"label-class":function(e){return t.labelClass(e)},"input-class":function(e){return t.inputClass(e)},"validation-messages":{isPhoneE164OrEmpty:t.$t("PRE_CHAT_FORM.FIELDS.PHONE_NUMBER.VALID_ERROR"),email:t.$t("PRE_CHAT_FORM.FIELDS.EMAIL_ADDRESS.VALID_ERROR"),required:t.$t("PRE_CHAT_FORM.REQUIRED")}}})})),t._v(" "),t.hasActiveCampaign?t._e():r("FormulateInput",{attrs:{name:"message",type:"textarea","label-class":function(e){return t.labelClass(e)},"input-class":function(e){return t.inputClass(e)},label:t.$t("PRE_CHAT_FORM.FIELDS.MESSAGE.LABEL"),placeholder:t.$t("PRE_CHAT_FORM.FIELDS.MESSAGE.PLACEHOLDER"),validation:"required","validation-messages":{required:t.$t("PRE_CHAT_FORM.FIELDS.MESSAGE.ERROR")}}}),t._v(" "),r("custom-button",{staticClass:"font-medium my-5",attrs:{block:"","bg-color":t.widgetColor,"text-color":t.textColor,disabled:t.isCreating}},[t.isCreating?r("spinner",{staticClass:"p-0"}):t._e(),t._v("\n    "+t._s(t.$t("START_CONVERSATION"))+"\n  ")],1)],2)}),[],!1,null,"1007e0f3",null).exports},mixins:[r(338).a,l.a],computed:g(g({},Object(n.mapGetters)({conversationSize:"conversation/getConversationSize"})),{},{disableContactFields:function(){var t=(this.$route.params||{}).disableContactFields,e=void 0!==t&&t;return e}}),watch:{conversationSize:function(t,e){!e&&t>e&&this.replaceRoute("messages")}},methods:{onSubmit:function(t){var e=t.fullName,r=t.emailAddress,n=t.message,a=t.activeCampaignId,o=t.phoneNumber,i=t.contactCustomAttributes,s=t.conversationCustomAttributes;a?(bus.$emit("execute-campaign",{campaignId:a,customAttributes:s}),this.$store.dispatch("contacts/update",{user:{email:r,name:e,phone_number:o}})):this.$store.dispatch("conversation/createConversation",{fullName:e,emailAddress:r,message:n,phoneNumber:o,customAttributes:s}),Object(u.d)(i)||this.$store.dispatch("contacts/setCustomAttributes",i)}}},y=Object(h.a)(C,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"flex flex-1 overflow-auto"},[r("pre-chat-form",{attrs:{options:t.preChatFormOptions,"disable-contact-fields":t.disableContactFields},on:{submit:t.onSubmit}})],1)}),[],!1,null,null,null);e.default=y.exports},665:function(t,e,r){"use strict";r(7);var n={props:{block:{type:Boolean,default:!1},type:{type:String,default:"blue"},bgColor:{type:String,default:""},textColor:{type:String,default:""},disabled:{type:Boolean,default:!1}},computed:{buttonClassName:function(){var t="text-white py-3 px-4 rounded shadow-sm";return"clear"===this.type&&(t="flex mx-auto mt-4 text-xs w-auto text-black-600"),"blue"!==this.type||Object.keys(this.buttonStyles).length||(t="".concat(t," bg-woot-500 hover:bg-woot-700")),this.block&&(t="".concat(t," w-full")),t},buttonStyles:function(){var t={};return this.bgColor&&(t.backgroundColor=this.bgColor),this.textColor&&(t.color=this.textColor),t}},methods:{onClick:function(t){this.$emit("click",t)}}},a=r(1),o=Object(a.a)(n,(function(){var t=this,e=t.$createElement;return(t._self._c||e)("button",{class:t.buttonClassName,style:t.buttonStyles,attrs:{disabled:t.disabled},on:{click:t.onClick}},[t._t("default")],2)}),[],!1,null,null,null);e.a=o.exports}}]);
//# sourceMappingURL=30-889fd8f55b2645e6ba9d.chunk.js.map